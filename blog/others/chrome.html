<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-others/chrome" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">chrome | tayce&#x27;s library</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tayceyun.github.io/img/orange.jpg"><meta data-rh="true" name="twitter:image" content="https://tayceyun.github.io/img/orange.jpg"><meta data-rh="true" property="og:url" content="https://tayceyun.github.io/blog/others/chrome"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="chrome | tayce&#x27;s library"><meta data-rh="true" name="description" content="http / 浏览器"><meta data-rh="true" property="og:description" content="http / 浏览器"><link data-rh="true" rel="icon" href="/img/logo.jpg"><link data-rh="true" rel="canonical" href="https://tayceyun.github.io/blog/others/chrome"><link data-rh="true" rel="alternate" href="https://tayceyun.github.io/blog/others/chrome" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://tayceyun.github.io/blog/others/chrome" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"chrome","item":"https://tayceyun.github.io/blog/others/chrome"}]}</script><link rel="stylesheet" href="/assets/css/styles.6859b9a8.css">
<script src="/assets/js/runtime~main.5450db74.js" defer="defer"></script>
<script src="/assets/js/main.87cc83e0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.jpg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.jpg" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">tayce&#x27;s library</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">💬 技术文章</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/blog/basis/js"><span title="前端基础" class="categoryLinkLabel_W154">前端基础</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/blog/basis/js"><span title="Javascript" class="categoryLinkLabel_W154">Javascript</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/blog/others/chrome"><span title="Http" class="categoryLinkLabel_W154">Http</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/others/chrome"><span title="chrome" class="linkLabel_WmDU">chrome</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/blog/basis/css"><span title="CSS" class="categoryLinkLabel_W154">CSS</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/blog/basis/algorithm"><span title="Algorithm" class="categoryLinkLabel_W154">Algorithm</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/blog/framework/vue"><span title="前端框架" class="categoryLinkLabel_W154">前端框架</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/blog/others/git"><span title="工具合集" class="categoryLinkLabel_W154">工具合集</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/blog/backend/linux"><span title="后端" class="categoryLinkLabel_W154">后端</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/blog/linklist"><span title="其他" class="categoryLinkLabel_W154">其他</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">前端基础</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Http</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">chrome</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>chrome</h1></header><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="http--浏览器">http / 浏览器<a href="#http--浏览器" class="hash-link" aria-label="http / 浏览器的直接链接" title="http / 浏览器的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="了解多进程浏览器">了解多进程浏览器<a href="#了解多进程浏览器" class="hash-link" aria-label="了解多进程浏览器的直接链接" title="了解多进程浏览器的直接链接" translate="no">​</a></h3>
<ul>
<li class="">
<p>进程之间是<strong>相互隔离</strong>的 ，当一个页面或者插件崩溃时，影响到的仅仅是当前的页面进程或者插件进程，并不会影响到浏览器和其他页面，从而解决了历史单进程浏览器中页面或者插件的崩溃会导致整个浏览器崩溃的问题。</p>
</li>
<li class="">
<p>Chrome 把插件进程和渲染进程锁在<a href="https://baike.baidu.com/item/Sandbox/9280944?fr=aladdin" target="_blank" rel="noopener noreferrer" class="">沙箱</a>里面，这样即使在渲染进程或者插件进程里面执行了恶意程序，恶意程序也无法突破沙箱去获取系统权限。</p>
</li>
<li class="">
<p>浏览器是多进程的优点：1️⃣ 默认新开一个 tab 页面新建一个进程,所以单个 tab 页面崩溃不会影响到整个浏览器。2️⃣ 第三方插件崩溃也不会影响到整个浏览器。3️⃣ 多进程可以充分利用现代 CPU 多核的优势。4️⃣ 方便使用沙盒模型隔离插件等进程,提高浏览器的稳定性。</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="chrome-浏览器包含哪些进程">chrome 浏览器包含哪些进程<a href="#chrome-浏览器包含哪些进程" class="hash-link" aria-label="chrome 浏览器包含哪些进程的直接链接" title="chrome 浏览器包含哪些进程的直接链接" translate="no">​</a></h3>
<ul>
<li class="">
<p><strong>浏览器进程</strong> ：主要负责界面显示、用户交互、子进程管理，同时提供存储等功能。</p>
</li>
<li class="">
<p><strong>渲染进程</strong>：核心任务是将 HTML、CSS 和 JavaScript 转换为用户可以与之交互的网页，排版引擎 Blink 和 JavaScript 引擎 V8 都是运行在该进程中，默认情况下， <strong>Chrome 会为每个 Tab 标签创建一个渲染进程</strong>。出于安全考虑，<strong>渲染进程都是运行在沙箱模式下</strong>。</p>
</li>
<li class="">
<p><strong>GPU 进程</strong>：Chrome 在其多进程架构上引入了 GPU 进程，网页、Chrome 的 UI 界面都采用 GPU 来绘制。</p>
</li>
<li class="">
<p><strong>网络进程</strong>：主要负责页面的网络资源加载。</p>
</li>
<li class="">
<p><strong>插件进程</strong>：主要是负责插件的运行，因插件易崩溃，所以需要通过插件进程来隔离，以保证插件进程崩溃不会对浏览器和页面造成影响。</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="浏览器内核中线程之间的关系">浏览器内核中线程之间的关系<a href="#浏览器内核中线程之间的关系" class="hash-link" aria-label="浏览器内核中线程之间的关系的直接链接" title="浏览器内核中线程之间的关系的直接链接" translate="no">​</a></h3>
<ul>
<li class="">GUI （Graphical User Interface）渲染线程和 JS 引擎线程互斥。js 是可以操作 DOM 的，如果在修改这些元素的同时渲染页面(js 线程和 ui 线程 同时运行)，那么渲染线程前后获得的元素数据可能就不一致了。</li>
<li class="">js 如果执行时间过长就会阻塞页面加载</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="js-单线程">js 单线程<a href="#js-单线程" class="hash-link" aria-label="js 单线程的直接链接" title="js 单线程的直接链接" translate="no">​</a></h3>
<p>Web Worker 的作用，就是为 JavaScript 创造多线程环境，允许主线程创建 Worker 线程，将一些任务分配给后者运行。但是<strong>子线程完全受主线程控制，且不得操作 DOM</strong>。一般使用 Web Worker 的场景是代码中有很多<strong>计算密集型或高延迟</strong>的任务，可以考虑分配给 Worker 线程。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="js-引擎线程和-gui-渲染线程互斥">js 引擎线程和 GUI 渲染线程互斥<a href="#js-引擎线程和-gui-渲染线程互斥" class="hash-link" aria-label="js 引擎线程和 GUI 渲染线程互斥的直接链接" title="js 引擎线程和 GUI 渲染线程互斥的直接链接" translate="no">​</a></h3>
<p>解释：js 是可以操作 DOM 的，如果在修改这些元素的同时渲染页面(js 线程和 ui 线程 同时运行)，那么渲染线程前后获得的元素数据可能就不一致了。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="chrome-打开一个页面需要启动多少进程">chrome 打开一个页面需要启动多少进程<a href="#chrome-打开一个页面需要启动多少进程" class="hash-link" aria-label="chrome 打开一个页面需要启动多少进程的直接链接" title="chrome 打开一个页面需要启动多少进程的直接链接" translate="no">​</a></h3>
<p>打开 1 个页面至少需要 1 个网络进程（页面网络资源加载）、1 个浏览器进程（界面显示，用户交互，子进程管理等功能）、1 个 GPU 进程（UI 界面绘制）以及 1 个 渲染进程（v8 引擎和排版引擎 Blink），</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="浏览器如何渲染网页">浏览器如何渲染网页<a href="#浏览器如何渲染网页" class="hash-link" aria-label="浏览器如何渲染网页的直接链接" title="浏览器如何渲染网页的直接链接" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/渲染网页-551b389f4be912c299993a17f9f259f5.png" width="494" height="225" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-处理-html-并构建-dom-树">1. 处理 HTML 并构建 DOM 树<a href="#1-处理-html-并构建-dom-树" class="hash-link" aria-label="1. 处理 HTML 并构建 DOM 树的直接链接" title="1. 处理 HTML 并构建 DOM 树的直接链接" translate="no">​</a></h4>
<p>当解析器到达 script 标签的时候，发生下面四件事情</p>
<blockquote>
<ol>
<li class="">html 解析器停止解析</li>
<li class="">如果是外部脚本，就从外部网络获取脚本代码</li>
<li class="">将控制权交给 js 引擎，执行 js 代码</li>
<li class="">恢复 html 解析器的控制权</li>
</ol>
</blockquote>
<p><strong>性能优化之：阻塞解析的 script 标签</strong></p>
<p>1️⃣ 将脚本放在网页尾部(body 标签底部)会加速代码渲染。原因：</p>
<p>2️⃣ script 标签的三个属性：</p>
<ul>
<li class="">
<p><strong>defer</strong>属性：立即请求文件，但不阻塞渲染引擎。页面 HTML 解析完成之后，<code>DOMContentLoaded</code> 事件触发之前按序依次执行</p>
</li>
<li class="">
<p><strong>async</strong> 属性：立即请求文件，但不阻塞渲染引擎。（脚本下载完成后立即执行，顺序不定）也能有助于加载外部脚本。</p>
</li>
<li class="">
<p>HTML5 标准 type 属性，对应值为&quot;module”。让浏览器按照 es6 标准将文件当作模块进行解析，<strong>默认阻塞效果同 defer，也可以配合 async 在请求完成后立即执行</strong>。</p>
</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-处理-css-构建-cssom-树">2. 处理 CSS 构建 CSSOM 树<a href="#2-处理-css-构建-cssom-树" class="hash-link" aria-label="2. 处理 CSS 构建 CSSOM 树的直接链接" title="2. 处理 CSS 构建 CSSOM 树的直接链接" translate="no">​</a></h4>
<p>⚠️ 在构建 CSSOM 树时会<strong>阻塞渲染</strong>，直至 CSSOM 树构建完成。并且构建 CSSOM 树是一个十分消耗性能的过程，所以应该尽量保证层级扁平，减少过度层叠，越是具体的 CSS 选择器，执行速度越慢。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-将-dom-与-cssom-合并成一个渲染树">3. 将 DOM 与 CSSOM 合并成一个渲染树<a href="#3-将-dom-与-cssom-合并成一个渲染树" class="hash-link" aria-label="3. 将 DOM 与 CSSOM 合并成一个渲染树的直接链接" title="3. 将 DOM 与 CSSOM 合并成一个渲染树的直接链接" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" src="/assets/images/render-82dbdb2534ac11fcbf795115cb4c2b8b.png" width="517" height="253" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-根据渲染树来布局计算每个节点的位置">4. 根据渲染树来布局，计算每个节点的位置<a href="#4-根据渲染树来布局计算每个节点的位置" class="hash-link" aria-label="4. 根据渲染树来布局，计算每个节点的位置的直接链接" title="4. 根据渲染树来布局，计算每个节点的位置的直接链接" translate="no">​</a></h4>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-调用-gpu-绘制合成图层显示在屏幕上">5. 调用 GPU 绘制，合成图层，显示在屏幕上<a href="#5-调用-gpu-绘制合成图层显示在屏幕上" class="hash-link" aria-label="5. 调用 GPU 绘制，合成图层，显示在屏幕上的直接链接" title="5. 调用 GPU 绘制，合成图层，显示在屏幕上的直接链接" translate="no">​</a></h4>
<p>一般来说，可以把普通文档流看成一个图层。特定的属性可以生成一个新的图层。不同的图层渲染互不影响，所以对于某些频繁需要渲染的建议单独生成一个新图层，提高性能。但也不能生成过多的图层，会引起反作用。</p>
<p><strong>页面重新渲染</strong>通常需要重复之前的第四步骤(重新生成布局)+第五步骤(重新绘制) 或者 只有第五步骤(重新绘制)</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="性能优化高效操作-dom">性能优化：高效操作 dom<a href="#性能优化高效操作-dom" class="hash-link" aria-label="性能优化：高效操作 dom的直接链接" title="性能优化：高效操作 dom的直接链接" translate="no">​</a></h2>
<ul>
<li class="">
<p>浏览器为了避免两个引擎同时修改页面而造成渲染结果不一致的情况，增加了另外一个机制，这两个引擎具有互斥性，也就是说在某个时刻只有一个引擎在运行，另一个引擎会被阻塞。操作系统在进行线程切换的时候需要保存上一个线程执行时的状态信息并读取下一个线程的状态信息，俗称上下文切换。而这个操作是比较耗时的</p>
</li>
<li class="">
<p>每次 DOM 操作就会引发线程的上下文切换--从 JavaScript 引擎切换到渲染引擎执行对应操作，然后再切换回 JavaScript 引擎继续执行，这就带来了性能损耗。单次切换消耗的时间是非常少的，但是如果频繁地大量切换，那么就会产生性能问题</p>
</li>
<li class="">
<p>【优化】：避免在循环中操作 dom；减少重绘和重排</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="缓存机制">缓存机制<a href="#缓存机制" class="hash-link" aria-label="缓存机制的直接链接" title="缓存机制的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="http-缓存的优点">http 缓存的优点<a href="#http-缓存的优点" class="hash-link" aria-label="http 缓存的优点的直接链接" title="http 缓存的优点的直接链接" translate="no">​</a></h3>
<ul>
<li class="">减少了冗余的数据传输，减少网费</li>
<li class="">减少服务器端的压力</li>
<li class="">Web 缓存能够减少延迟与网络阻塞，进而减少显示某个资源所用的时间</li>
<li class="">加快客户端加载网页的速度</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="http-缓存执行过程">http 缓存执行过程<a href="#http-缓存执行过程" class="hash-link" aria-label="http 缓存执行过程的直接链接" title="http 缓存执行过程的直接链接" translate="no">​</a></h3>
<p>⚠️ 强缓存（<code>Cache-Control</code> / <code>Expires</code>）优先级<strong>高于</strong>协商缓存（<code>Last-Modified</code> / <code>If-Modified-Since</code> 或 <code>ETag</code> / <code>If-None-Match</code>）</p>
<p>⚠️ 在协商缓存中，<code>ETag</code>优先级比<code>Last-Modified</code>高</p>
<p>⚠️ 当 ctrl+f5 强制刷新网页时，直接从服务器加载，跳过强缓存和协商缓存</p>
<p>⚠️ 当 f5 刷新网页时，跳过强缓存，但是会检查协商缓存</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="执行过程">执行过程<a href="#执行过程" class="hash-link" aria-label="执行过程的直接链接" title="执行过程的直接链接" translate="no">​</a></h3>
<blockquote>
<p>第一次浏览器发送请求给服务器时，此时浏览器还没有本地缓存副本，服务器返回资源给浏览器，响应码是 200 OK ，浏览器收到资源后，把<strong>资源和对应的响应头</strong>一起缓存下来。</p>
<p>第二次浏览器准备发送请求给服务器时，浏览器会先检查上一次服务端返回的响应头信息中的<code>Cache-Control</code>，它的值是一个相对值，单位为秒，表示资源在客户端缓存的最大有效期，过期时间为第一次请求的时间减去<code>Cache-Control</code>的值，过期时间跟当前的请求时间比较，如果本地缓存资源没过期，那么命中缓存，不再请求服务器(<strong>强缓存</strong>)。</p>
<p>如果没有命中，浏览器就会把请求发送给服务器，进入<a href="#%E7%BC%93%E5%AD%98%E5%8D%8F%E5%95%86" class="">缓存协商</a>阶段。</p>
</blockquote>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="cache-control和expires"><code>Cache-Control</code>和<code>Expires</code><a href="#cache-control和expires" class="hash-link" aria-label="cache-control和expires的直接链接" title="cache-control和expires的直接链接" translate="no">​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="cache-control常见值"><code>Cache-Control</code>常见值<a href="#cache-control常见值" class="hash-link" aria-label="cache-control常见值的直接链接" title="cache-control常见值的直接链接" translate="no">​</a></h5>
<p><img decoding="async" loading="lazy" src="/assets/images/cache-5bf618aac5f92615f2dc62a45f324544.png" width="531" height="283" class="img_ev3q"></p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="expires"><code>Expires</code><a href="#expires" class="hash-link" aria-label="expires的直接链接" title="expires的直接链接" translate="no">​</a></h5>
<p>是一个绝对时间。时间格式是如 Mon,10 Jun 2020 10:10:10 GMT，只要发送请求时间是在<code>Expires</code>之前，那么本地缓存始终有效，否则就会去服务器发送请求获取新的资源。如果同时出现<code>Cache-Control:max-age</code>和<code>Expires</code> ，<code>max-age</code>优先级更高。</p>
<p>‼️ 两者也可以组合使用：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cache</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Control</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">Expires</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Wed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Jan </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2018</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">00</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">27</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">04</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">GMT</span><br></span></code></pre></div></div>
<p><a name="缓存协商" class=""></a></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="缓存协商">缓存协商<a href="#缓存协商" class="hash-link" aria-label="缓存协商的直接链接" title="缓存协商的直接链接" translate="no">​</a></h3>
<p>❓ 什么情况会进入缓存协商阶段</p>
<p>当第一次请求时服务器返回的响应头中存在以下情况时：</p>
<p>1️⃣ 没有<code>Cache-Control</code>和<code>Expires</code></p>
<p>2️⃣<code>Cache-Control</code>和<code>Expires</code>已过期</p>
<p>3️⃣<code>Cache-Control</code>设置为<code>no-cache</code></p>
<p>浏览器第二次请求时就会与服务器进行协商，询问浏览器中的缓存资源是不是旧版本，需不需要更新。</p>
<p>服务器会进行判断，如果缓存和服务端资源的最新版本是一致的，那么就无需再次下载该资源，服务端直接返回 304 Not Modified 状态码。</p>
<p>如果服务器发现浏览器中的缓存已经是旧版本了， 那么服务器就会把最新资源的完整内容返回给浏览器，状态码就是 200 Ok。</p>
<p>那么服务端是根据什么来判断浏览器的缓存是不是最新的呢?</p>
<p>【协商缓存】其实是根据 HTTP 的另外两组头信息，分别是：<code>Last-Modified</code> / <code>If-Modified-Since</code> 与 <code>ETag</code> / <code>If-None-Match</code></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="last-modified--if-modified-since"><code>Last-Modified</code> / <code>If-Modified-Since</code><a href="#last-modified--if-modified-since" class="hash-link" aria-label="last-modified--if-modified-since的直接链接" title="last-modified--if-modified-since的直接链接" translate="no">​</a></h4>
<p><strong>根据资源修改时间判断资源有无更新</strong></p>
<p>浏览器第一次请求资源时，服务器会把资源的<strong>最新修改时间</strong>(Last-Modified)放在响应头中返回给浏览器；</p>
<p>第二次请求时，浏览器就会把上一次服务器返回的修改时间放在请求头(If-Modified-Since)发送给服务器，服务器就会拿这个时间跟服务器上的资源的最新修改时间进行对比；</p>
<p>服务端会根据请求头<code>If-Modified-Since</code>的值，判断相关资源是否有变化，如果没有，则返回 304 Not Modified，并且不返回资源内容，浏览器使用资源缓存值;否则正常返回资源内容，且更新(Last-Modified)响应头内容。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="以上方式存在的问题-">以上方式存在的问题 🙋<a href="#以上方式存在的问题-" class="hash-link" aria-label="以上方式存在的问题 🙋的直接链接" title="以上方式存在的问题 🙋的直接链接" translate="no">​</a></h5>
<ul>
<li class="">
<p>精度问题：<code>Last-Modified</code>的时间精度为秒，如果在 1 秒内发生修改，那么缓存判断可能会失效;</p>
</li>
<li class="">
<p>准度问题：存在一种情况，例如一个文件被修改，然后又被还原，内容并没有发生变化，在这种情况下，浏览器的缓存还可以继续使用，但因为修改时间发生变化，也会重新返回重复的内容。</p>
</li>
</ul>
<p><strong>根据资源内容判断有无更新(基于资源的内容的摘要信息(比如 MD5 hash-信息摘要算法 )来判断)</strong></p>
<p>浏览器第一次请求资源，服务端在返响应头中加入 <code>ETag</code> 字段， <code>ETag</code> 字段值为该资源的哈希值。</p>
<p>浏览器发送第二次请求时，会把第一次的响应头信息 <code>ETag</code> 的值放在 <code>If-None-Match</code> 的请求头中发送到服务器，服务器将请求头中<code>If-None-Match</code>字段值和最新的资源的哈希值对比，如果相等则返回 304 Not Modified，否则内容有更新，将最新的资源连同最新的摘要信息返回。</p>
<p>用 <code>ETag</code> 的好处是如果因为某种原因到时资源的修改时间没改变，那么用 <code>ETag</code> 就能区分资源是不是有被更新。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="以上方式存在的问题--1">以上方式存在的问题 🙋<a href="#以上方式存在的问题--1" class="hash-link" aria-label="以上方式存在的问题 🙋的直接链接" title="以上方式存在的问题 🙋的直接链接" translate="no">​</a></h5>
<ul>
<li class="">
<p>计算成本：生成哈希值相对于读取文件修改时间而言是一个开销比较大的操作，尤其是对于大文件而言。如果要精确计算则需读取完整的文件内容，如果从性能方面考虑，只读取文件部分内容又容易判断出错。</p>
</li>
<li class="">
<p>计算误差：HTTP 并没有规定哈希值的计算方法，所以不同服务端可能会采用不同的哈希值计算方式。这样带来的问题是，同一个资源在两台服务端产生的 <code>Etag</code> 可能是不相同的，所以对于使用服务器集群来处理请求的网站来说，使用 <code>Etag</code> 的缓存命中率会有所降低。</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="缓存位置优先级从高到低排列">缓存位置,优先级从高到低排列<a href="#缓存位置优先级从高到低排列" class="hash-link" aria-label="缓存位置,优先级从高到低排列的直接链接" title="缓存位置,优先级从高到低排列的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><code>Service Worker Cache</code>：离线缓存</li>
<li class=""><code>Memory Cache</code>：内存缓存 （效率最快，当渲染进程结束后，内存缓存释放）</li>
<li class=""><code>Disk Cache</code>：磁盘缓存（存取效率比内存缓存慢，存储容量大，存储时间长）</li>
<li class=""><code>Push Cache</code>：推送缓存</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cookie">cookie<a href="#cookie" class="hash-link" aria-label="cookie的直接链接" title="cookie的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cookie-的属性">cookie 的属性<a href="#cookie-的属性" class="hash-link" aria-label="cookie 的属性的直接链接" title="cookie 的属性的直接链接" translate="no">​</a></h3>
<p>1️⃣<code>value</code>：如果用于保存用户登录态，应该将该值加密，不能使用明文的用户标识</p>
<p>2️⃣<code>http-only</code>：不能通过 js 访问 cookie，减少 xss 攻击</p>
<p>3️⃣<code>secure</code>：只能在协议为 HTTPS 的请求中携带</p>
<p>4️⃣<code>same-site</code>：规定浏览器不能在跨域请求中携带 cookie，减少 csrf 攻击</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cookie-3abf181f1f9f83a77e4ece02339c6f07.png" width="522" height="480" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="跨域">跨域<a href="#跨域" class="hash-link" aria-label="跨域的直接链接" title="跨域的直接链接" translate="no">​</a></h2>
<p>❓webpack 实现反向代理</p>
<p>1️⃣config 文件</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&#x27;/api&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://www.example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// your target host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token literal-property property" style="color:#36acaa">changeOrigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// needed for virtual hosted sites</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token literal-property property" style="color:#36acaa">pathRewrite</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&#x27;^/api&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// rewrite path</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<p>2️⃣http-proxy-middleware 插件对 api 请求地址代理</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> proxy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;http-proxy-middleware&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// proxy api requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> exampleProxy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 这里的 options 就是 webpack 里面的 proxy 选项对应的每个选项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// mount `exampleProxy` in web server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/api&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exampleProxy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>3️⃣nginx 把允许跨域的源地址添加到报头里面即可</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="xss-和-csrf">XSS 和 CSRF<a href="#xss-和-csrf" class="hash-link" aria-label="XSS 和 CSRF的直接链接" title="XSS 和 CSRF的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="xsscross-site-scripting跨站脚本攻击">XSS（Cross Site Scripting）跨站脚本攻击<a href="#xsscross-site-scripting跨站脚本攻击" class="hash-link" aria-label="XSS（Cross Site Scripting）跨站脚本攻击的直接链接" title="XSS（Cross Site Scripting）跨站脚本攻击的直接链接" translate="no">​</a></h3>
<p>理解：攻击者想尽办法将可执行的代码注入到网页中</p>
<p>常见 xss 攻击举例：</p>
<ul>
<li class="">窃取网页浏览中的 cookie 值,获取用户敏感信息</li>
<li class="">劫持流量实现恶意跳转<code>&lt;script&gt;window.location.href=&quot;http://www.baidu.com&quot;;&lt;/script&gt;</code></li>
<li class="">利用一些可被攻击的域或其它的域信任的特点，以受信任来源的身份请求一些平时不被允许的操作</li>
</ul>
<p>❓ 如何防止 xss 攻击</p>
<ul>
<li class="">输入检查</li>
<li class="">输出检查</li>
<li class="">转义</li>
<li class="">设置白名单/黑名单过滤</li>
<li class="">设置 http only 属性，则客户端的脚本就不能获取到 cookie 信息</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="cspcontent-security-policy">CSP(Content Security Policy)<a href="#cspcontent-security-policy" class="hash-link" aria-label="CSP(Content Security Policy)的直接链接" title="CSP(Content Security Policy)的直接链接" translate="no">​</a></h4>
<p>CSP 是一种内容安全策略，它用于指示浏览器如何处理页面上的内容，以减少跨站脚本（XSS）攻击的风险。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="实现方式">实现方式<a href="#实现方式" class="hash-link" aria-label="实现方式的直接链接" title="实现方式的直接链接" translate="no">​</a></h5>
<p>1.meta 标签设置 CSP</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Content-Security-Policy</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; https://api.example.com</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f"></span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre></div></div>
<p>2.使用 HTTP 响应头设置 CSP</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Content</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Security</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Policy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> script</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">src </span><span class="token string" style="color:#e3116c">&#x27;self&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 只允许加载本站资源</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="csrfcross-site-request-forgery跨站请求伪造">CSRF（Cross-site request forgery）跨站请求伪造<a href="#csrfcross-site-request-forgery跨站请求伪造" class="hash-link" aria-label="CSRF（Cross-site request forgery）跨站请求伪造的直接链接" title="CSRF（Cross-site request forgery）跨站请求伪造的直接链接" translate="no">​</a></h3>
<p>理解：攻击者盗用了你的身份，以你的名义发送恶意请求。CSRF 的关键点在于，<strong>跨域请求时会自动携带第三方网站的 cookie</strong></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="原理">原理<a href="#原理" class="hash-link" aria-label="原理的直接链接" title="原理的直接链接" translate="no">​</a></h4>
<p>1.用户 C 打开浏览器，访问受信任网站 A，输入用户名和密码请求登录网站 A;</p>
<p>2.在用户信息通过验证后，网站 A 产生 Cookie 信息并返回给浏览器，此时用户登录网站 A 成功，可以正常发送请求到网站 A;</p>
<p>3.用户未退出网站 A 之前，在同一浏览器中，打开一个 TAB 页访问网站 B;</p>
<p>4.网站 B 接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点 A;</p>
<p>5.浏览器在接收到这些攻击性代码后，根据网站 B 的请求，在用户不知情的情况下携带 Cookie 信息，向网站 A 发出请求。网站 A 并不知道该请求其实是由 B 发起的，所以会根据用户 C 的 Cookie 信息以 C 的权限处理该请求，导致来自网站 B 的恶意代码被执行。</p>
<p>❓ 如何防止 csrf 攻击</p>
<ul>
<li class="">验证码</li>
<li class="">Cookie 设置 SameSite 属性
SameSite 属性的值：
<ul>
<li class="">None： 任何情况下都会向第三方网站请求发送 Cookie</li>
<li class="">⭐️Lax：【目前主流浏览器的默认值】只有导航到第三方网站的 Get 链接会发送 Cookie。而跨域的图片 iframe、「fetch 请求，form 表单都不会发送 Cookie</li>
<li class="">Strict：任何情况下都不会向第三方网站请求发送 Cookie</li>
</ul>
</li>
<li class="">Token：在请求头中带上 Authorization 字段，服务器验证 Token 是否合法</li>
<li class="">Referer check：HTTP 请求头中验证<code>Referer</code>字段，<code>Referer</code>字段记录了该 HTTP 请求的来源地址。Origin 属性只包含了域名信息，没有包含具体的 URL 路径</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="语义化标签">语义化标签<a href="#语义化标签" class="hash-link" aria-label="语义化标签的直接链接" title="语义化标签的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="语义化结构的页面优势">语义化结构的页面优势<a href="#语义化结构的页面优势" class="hash-link" aria-label="语义化结构的页面优势的直接链接" title="语义化结构的页面优势的直接链接" translate="no">​</a></h3>
<p>语义类标签对开发者更为友好，使用语义类标签增强了可读性，即便是在没有 CSS 的时候，开发者也能够清晰地看出网页的结构，也更为便于团队的开发和维护。</p>
<p>除了对人类友好之外，语义类标签也十分适宜机器阅读。它的文字表现力丰富，更适合搜索引擎检索(SEO)，也可以让搜索引擎爬虫更好地获取到更多有效信息，有效提升网页的搜索量，并且语义类还可以支持读屏软件，根据文章可以自动生成目录等等。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="常见的语义化标签">常见的语义化标签<a href="#常见的语义化标签" class="hash-link" aria-label="常见的语义化标签的直接链接" title="常见的语义化标签的直接链接" translate="no">​</a></h3>
<ul>
<li class="">
<p><code>ul</code>：无序列表</p>
</li>
<li class="">
<p><code>ol</code>：有序列表</p>
</li>
<li class="">
<p><code>article</code>：文章主体</p>
</li>
<li class="">
<p><code>em</code>：重音</p>
</li>
<li class="">
<p><code>strong</code>：表示词很重要</p>
</li>
<li class="">
<p><code>abbr</code>：缩写</p>
</li>
<li class="">
<p><code>p</code>：普通段落</p>
</li>
<li class="">
<p><code>hr</code>：横向分隔线，表示故事走向的转变或者话题的转变</p>
</li>
<li class="">
<p><code>header</code>：通常出现在前部，表示导航或者介绍性的内容（header 中的导航多数是到文章自己的目录）。</p>
</li>
<li class="">
<p><code>footer</code>：通常出现在尾部，包含一些作者信息、相关链接、版权信息等</p>
</li>
<li class="">
<p><code>aside</code>：表示跟文章主体不那么相关的部分，它可能包含导航、广告等工具性质的内容（aside 中的导航多数是到关联页面或者是整站地图）。</p>
</li>
<li class="">
<p><code>address</code>：表示“文章(作者)的联系方式”，address 明确地只关联到 article 和 body。</p>
</li>
<li class="">
<p><code>hgroup</code>：避免副标题产生额外的一个层级</p>
</li>
<li class="">
<p><code>blockquote</code>：表示段落级引述内容</p>
</li>
<li class="">
<p><code>q</code>：表示行内的引述内容</p>
</li>
<li class="">
<p><code>cite</code>：表示引述的作品名</p>
</li>
<li class="">
<p><code>figure</code>：用于表示与主文章相关的图像、照片等流内容</p>
</li>
<li class="">
<p><code>figcaption</code>：在<code>figure</code>标签内使用，表示图片内容的标题等</p>
</li>
<li class="">
<p><code>pre</code>：表示这部分内容是预先排版过的，不需要浏览器进行排版。</p>
<ul>
<li class="">示例</li>
</ul>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">figure</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://.....440px-NeXTcube_first_webserver.JPG</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">figcaption</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">The NeXT Computer used by Tim Berners-Lee at CERN.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">figcaption</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">figure</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<ul>
<li class="">
<p>语义化的 HTML 能够支持自动生成目录结构。h1-h6 是最基本的标题，它们表示了文章中不同层级的标题。有时候可能会有副标题，为了避免副标题产生额外的一个层级，可以使用 <code>hgroup</code> 标签。</p>
<p>示例</p>
</li>
</ul>
</li>
</ul>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hgroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">JavaScript 对象</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">我们需要模拟类吗?</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">hgroup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">balah balah</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>页面展示</p>
<p><img decoding="async" loading="lazy" src="/assets/images/hgroup-1f4d692ad6ffddb04f9e6c3ad90bf5e9.png" width="866" height="200" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="示例整体结构类的语义标签">【示例】整体结构类的语义标签<a href="#示例整体结构类的语义标签" class="hash-link" aria-label="【示例】整体结构类的语义标签的直接链接" title="【示例】整体结构类的语义标签的直接链接" translate="no">​</a></h3>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">......</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">aside</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">......</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">aside</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">section</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">......</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">section</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">section</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">......</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">section</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">footer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">address</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">......</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">address</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">footer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/html">html</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/chrome">chrome</a></li></ul></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/basis/ts"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">ts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/basis/css"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">css</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#http--浏览器" class="table-of-contents__link toc-highlight">http / 浏览器</a><ul><li><a href="#了解多进程浏览器" class="table-of-contents__link toc-highlight">了解多进程浏览器</a></li><li><a href="#chrome-浏览器包含哪些进程" class="table-of-contents__link toc-highlight">chrome 浏览器包含哪些进程</a></li><li><a href="#浏览器内核中线程之间的关系" class="table-of-contents__link toc-highlight">浏览器内核中线程之间的关系</a></li><li><a href="#js-单线程" class="table-of-contents__link toc-highlight">js 单线程</a></li><li><a href="#js-引擎线程和-gui-渲染线程互斥" class="table-of-contents__link toc-highlight">js 引擎线程和 GUI 渲染线程互斥</a></li><li><a href="#chrome-打开一个页面需要启动多少进程" class="table-of-contents__link toc-highlight">chrome 打开一个页面需要启动多少进程</a></li><li><a href="#浏览器如何渲染网页" class="table-of-contents__link toc-highlight">浏览器如何渲染网页</a></li></ul></li><li><a href="#性能优化高效操作-dom" class="table-of-contents__link toc-highlight">性能优化：高效操作 dom</a></li><li><a href="#缓存机制" class="table-of-contents__link toc-highlight">缓存机制</a><ul><li><a href="#http-缓存的优点" class="table-of-contents__link toc-highlight">http 缓存的优点</a></li><li><a href="#http-缓存执行过程" class="table-of-contents__link toc-highlight">http 缓存执行过程</a></li><li><a href="#执行过程" class="table-of-contents__link toc-highlight">执行过程</a></li><li><a href="#缓存协商" class="table-of-contents__link toc-highlight">缓存协商</a></li><li><a href="#缓存位置优先级从高到低排列" class="table-of-contents__link toc-highlight">缓存位置,优先级从高到低排列</a></li></ul></li><li><a href="#cookie" class="table-of-contents__link toc-highlight">cookie</a><ul><li><a href="#cookie-的属性" class="table-of-contents__link toc-highlight">cookie 的属性</a></li></ul></li><li><a href="#跨域" class="table-of-contents__link toc-highlight">跨域</a></li><li><a href="#xss-和-csrf" class="table-of-contents__link toc-highlight">XSS 和 CSRF</a><ul><li><a href="#xsscross-site-scripting跨站脚本攻击" class="table-of-contents__link toc-highlight">XSS（Cross Site Scripting）跨站脚本攻击</a></li><li><a href="#csrfcross-site-request-forgery跨站请求伪造" class="table-of-contents__link toc-highlight">CSRF（Cross-site request forgery）跨站请求伪造</a></li></ul></li><li><a href="#语义化标签" class="table-of-contents__link toc-highlight">语义化标签</a><ul><li><a href="#语义化结构的页面优势" class="table-of-contents__link toc-highlight">语义化结构的页面优势</a></li><li><a href="#常见的语义化标签" class="table-of-contents__link toc-highlight">常见的语义化标签</a></li><li><a href="#示例整体结构类的语义标签" class="table-of-contents__link toc-highlight">【示例】整体结构类的语义标签</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 tayce's library. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>