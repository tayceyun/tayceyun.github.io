"use strict";(globalThis.webpackChunktayceyun_library=globalThis.webpackChunktayceyun_library||[]).push([[5163],{13299:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/vnode-20cce3e420431b67b4fa9495de60a5d1.png"},13948:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/menu-7a56d914ac3639e0de2a4a18ad993a2c.png"},15086:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/\u7f16\u8bd1-89a949c9e30508e13d3e5029555454b9.png"},17698:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>o,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"others/resource","title":"resource","description":"\u524d\u7f6e\u77e5\u8bc6","source":"@site/docs/others/resource.md","sourceDirName":"others","slug":"/others/resource","permalink":"/blog/others/resource","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"mainSidebar","previous":{"title":"harmony","permalink":"/blog/framework/harmony"},"next":{"title":"git","permalink":"/blog/others/git"}}');var i=r(74848),l=r(28453);const o={},d=void 0,c={},t=[{value:"\u524d\u7f6e\u77e5\u8bc6",id:"\u524d\u7f6e\u77e5\u8bc6",level:2},{value:"1.monorepo",id:"1monorepo",level:3},{value:"\u4e86\u89e3 monorepo",id:"\u4e86\u89e3-monorepo",level:4},{value:"Monorepo \u7684\u4f18\u7f3a\u70b9",id:"monorepo-\u7684\u4f18\u7f3a\u70b9",level:4},{value:"\u5305\u7ba1\u7406\u5de5\u5177",id:"\u5305\u7ba1\u7406\u5de5\u5177",level:4},{value:"\u5728\u6267\u884c <code>npm install</code> \u7684\u65f6\u5019\u53d1\u751f\u4e86\u4ec0\u4e48\uff1f",id:"\u5728\u6267\u884c-npm-install-\u7684\u65f6\u5019\u53d1\u751f\u4e86\u4ec0\u4e48",level:5},{value:"package-lock.json \u6587\u4ef6\u7684\u4f5c\u7528\uff1f",id:"package-lockjson-\u6587\u4ef6\u7684\u4f5c\u7528",level:5},{value:"npm run xxx \u53d1\u751f\u4e86\u4ec0\u4e48\uff1f",id:"npm-run-xxx-\u53d1\u751f\u4e86\u4ec0\u4e48",level:5},{value:"Workspace \u5de5\u4f5c\u533a",id:"workspace-\u5de5\u4f5c\u533a",level:5},{value:"\u2753 \u4e3a\u4ec0\u4e48 pnpm+Monorepo \u662f\u76ee\u524d\u7684\u6700\u4f73\u5b9e\u8df5",id:"-\u4e3a\u4ec0\u4e48-pnpmmonorepo-\u662f\u76ee\u524d\u7684\u6700\u4f73\u5b9e\u8df5",level:4},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:5},{value:"2.proxy",id:"2proxy",level:3},{value:"\u57fa\u7840\u4f7f\u7528",id:"\u57fa\u7840\u4f7f\u7528",level:4},{value:"proxy \u7684\u4f5c\u7528",id:"proxy-\u7684\u4f5c\u7528",level:4},{value:"\u53c2\u6570 handler \u5bf9\u8c61\u7684\u5e38\u7528\u65b9\u6cd5",id:"\u53c2\u6570-handler-\u5bf9\u8c61\u7684\u5e38\u7528\u65b9\u6cd5",level:4},{value:"\u53ef\u64a4\u6d88\u7684 Proxy(\u5e38\u7528\u4e8e\u5b8c\u5168\u5c01\u95ed\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee)",id:"\u53ef\u64a4\u6d88\u7684-proxy\u5e38\u7528\u4e8e\u5b8c\u5168\u5c01\u95ed\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee",level:4},{value:"proxy \u4f7f\u7528\u573a\u666f\u793a\u4f8b",id:"proxy-\u4f7f\u7528\u573a\u666f\u793a\u4f8b",level:4},{value:"3.Object.defineProperty",id:"3objectdefineproperty",level:3},{value:"\u57fa\u7840\u4f7f\u7528",id:"\u57fa\u7840\u4f7f\u7528-1",level:4},{value:"vue2 \u5185\u90e8\u5bf9\u4e8e\u6570\u7ec4\u53d8\u5f02\u7684\u65b9\u6cd5\u5904\u7406",id:"vue2-\u5185\u90e8\u5bf9\u4e8e\u6570\u7ec4\u53d8\u5f02\u7684\u65b9\u6cd5\u5904\u7406",level:4},{value:"vue3 vs vue2",id:"vue3-vs-vue2",level:2},{value:"\u7ec4\u4ef6",id:"\u7ec4\u4ef6",level:2},{value:"\u5e94\u7528\u7a0b\u5e8f\u521d\u59cb\u5316",id:"\u5e94\u7528\u7a0b\u5e8f\u521d\u59cb\u5316",level:3},{value:"<code>createApp</code>\u5185\u90e8\u5b9e\u73b0",id:"createapp\u5185\u90e8\u5b9e\u73b0",level:4},{value:"\u6838\u5fc3\u6e32\u67d3\u6d41\u7a0b\uff08\u521b\u5efa vnode &amp; \u6e32\u67d3 vnode\uff09",id:"\u6838\u5fc3\u6e32\u67d3\u6d41\u7a0b\u521b\u5efa-vnode--\u6e32\u67d3-vnode",level:2},{value:"h()\u51fd\u6570\u7684\u5b9a\u4e49",id:"h\u51fd\u6570\u7684\u5b9a\u4e49",level:3},{value:"h()\u51fd\u6570\u7684\u53c2\u6570",id:"h\u51fd\u6570\u7684\u53c2\u6570",level:3},{value:"vnode \u7684\u7c7b\u578b",id:"vnode-\u7684\u7c7b\u578b",level:3},{value:"vnode \u7684\u4f18\u52bf",id:"vnode-\u7684\u4f18\u52bf",level:3},{value:"\u521b\u5efa vnode\uff1a<code>createVNode</code>\u5185\u90e8\u5b9e\u73b0",id:"\u521b\u5efa-vnodecreatevnode\u5185\u90e8\u5b9e\u73b0",level:3},{value:"\u6e32\u67d3 vnode",id:"\u6e32\u67d3-vnode",level:5},{value:"vue3 \u6e90\u7801\u7ed3\u6784",id:"vue3-\u6e90\u7801\u7ed3\u6784",level:2},{value:"packages",id:"packages",level:3},{value:"\u5b9a\u4e49\u54cd\u5e94\u5f0f\u6570\u636e",id:"\u5b9a\u4e49\u54cd\u5e94\u5f0f\u6570\u636e",level:3},{value:"nextTick",id:"nexttick",level:2},{value:"nextTick \u7684\u51fa\u73b0\u662f\u56e0\u4e3a dom \u7684\u66f4\u65b0\u662f\u5f02\u6b65\u7684",id:"nexttick-\u7684\u51fa\u73b0\u662f\u56e0\u4e3a-dom-\u7684\u66f4\u65b0\u662f\u5f02\u6b65\u7684",level:3},{value:"\u5b9e\u73b0 nextTick",id:"\u5b9e\u73b0-nexttick",level:3},{value:"\u2753vue3 \u4e2d\u4efb\u52a1\u8c03\u5ea6\u7684\u5b9e\u73b0\u8fc7\u7a0b",id:"vue3-\u4e2d\u4efb\u52a1\u8c03\u5ea6\u7684\u5b9e\u73b0\u8fc7\u7a0b",level:3},{value:"vue \u6e32\u67d3\u8fc7\u7a0b",id:"vue-\u6e32\u67d3\u8fc7\u7a0b",level:3},{value:"keep-alive \u539f\u7406",id:"keep-alive-\u539f\u7406",level:3},{value:"\u539f\u7406",id:"\u539f\u7406",level:4},{value:"diff",id:"diff",level:3}];function p(n){const e={code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"\u524d\u7f6e\u77e5\u8bc6",children:"\u524d\u7f6e\u77e5\u8bc6"}),"\n",(0,i.jsx)(e.h3,{id:"1monorepo",children:"1.monorepo"}),"\n",(0,i.jsx)(e.h4,{id:"\u4e86\u89e3-monorepo",children:"\u4e86\u89e3 monorepo"}),"\n",(0,i.jsx)(e.p,{children:"\u5f53\u4e0b\u524d\u7aef\u7ec4\u4ef6\u5e93 / \u5de5\u5177\u5e93\u7684\u6700\u4f73\u5b9e\u8df5\u65b9\u6848\u57fa\u672c\u90fd\u662f pnpm + monorepo \u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u5982 Vue\u3001React\u3001Vite\u3001Element UI\u3001Varlet UI\u3001Vant UI \u7b49\u3002"}),"\n",(0,i.jsxs)(e.p,{children:['Monorepo\uff08\u5355\u4ed3\u591a\u6a21\u5757\uff09 \u662f\u4e00\u79cd\u9879\u76ee\u5f00\u53d1\u4e0e\u7ba1\u7406\u7684\u7b56\u7565\u6a21\u5f0f\uff0c\u5b83\u4ee3\u8868"\u5355\u4e00\u4ee3\u7801\u4ed3\u5e93"\uff08Monolithic Repository\uff09\u3002\u5728 Monorepo \u6a21\u5f0f\u4e2d\uff0c',(0,i.jsx)(e.strong,{children:"\u6240\u6709\u76f8\u5173\u7684\u9879\u76ee\u548c\u7ec4\u4ef6\u90fd\u88ab\u5b58\u50a8\u5728\u4e00\u4e2a\u7edf\u4e00\u7684\u4ee3\u7801\u4ed3\u5e93\u4e2d"}),"\uff0c\u800c\u4e0d\u662f\u5206\u6563\u5728\u591a\u4e2a\u72ec\u7acb\u7684\u4ee3\u7801\u4ed3\u5e93\u4e2d\uff0c\u8fd9\u4e9b\u9879\u76ee\u4e4b\u95f4\u8fd8\u53ef\u80fd\u4f1a\u6709\u4f9d\u8d56\u5173\u7cfb\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728 Monorepo \u4e2d\uff0c\u6bcf\u4e2a\u5b50\u6a21\u5757\u4ecd\u7136\u662f\u72ec\u7acb\u7684\uff0c\u6709\u72ec\u7acb\u7684\u7248\u672c\uff0c\u53ef\u4ee5\u72ec\u7acb\u53d1\u5305\uff0c\u4e0d\u53d7\u5176\u4ed6\u6a21\u5757\u7684\u9650\u5236\u3002\u6700\u91cd\u8981\u7684\u662f Monorepo \u7684 build\u3001test \u90fd\u662f\u589e\u91cf\u7684\uff0c\u53ea\u6709\u53d1\u751f\u66f4\u6539\u7684\u5b50\u6a21\u5757\u4f1a\u8fdb\u884c\u6784\u5efa\u548c\u6d4b\u8bd5\uff0c\u800c\u4e0d\u9700\u8981\u91cd\u65b0\u6784\u5efa\u548c\u6d4b\u8bd5\u6574\u4e2a\u4ee3\u7801\u5e93\u3002\u8fd9\u53ef\u4ee5\u5927\u5927\u52a0\u5feb\u6301\u7eed\u96c6\u6210\uff08CI\uff09\u7684\u901f\u5ea6\uff0c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"monorepo-\u7684\u4f18\u7f3a\u70b9",children:"Monorepo \u7684\u4f18\u7f3a\u70b9"}),"\n",(0,i.jsx)(e.p,{children:"\u3010\u4f18\u70b9\u3011"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u4ee3\u7801\u590d\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u6a21\u5757\u72ec\u7acb\u7ba1\u7406"}),"\n",(0,i.jsx)(e.li,{children:"\u5206\u5de5\u660e\u786e\uff0c\u4e1a\u52a1\u573a\u666f\u72ec\u7acb"}),"\n",(0,i.jsx)(e.li,{children:"\u4ee3\u7801\u8026\u5408\u5ea6\u964d\u4f4e"}),"\n",(0,i.jsx)(e.li,{children:"\u7ba1\u7406\u6240\u6709\u9879\u76ee\u7684\u7248\u672c\u63a7\u5236\u66f4\u52a0\u5bb9\u6613\u548c\u4e00\u81f4\uff0c\u964d\u4f4e\u4e86\u4e0d\u540c\u9879\u76ee\u4e4b\u95f4\u7684\u7248\u672c\u51b2\u7a81"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u4ee5\u7edf\u4e00\u9879\u76ee\u7684\u6784\u5efa\u548c\u90e8\u7f72\u6d41\u7a0b\uff0c\u964d\u4f4e\u4e86\u914d\u7f6e\u548c\u7ef4\u62a4\u591a\u4e2a\u9879\u76ee\u6240\u9700\u7684\u5de5\u4f5c\u91cf"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u3010\u7f3a\u70b9\u3011"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u6743\u9650\u7ba1\u7406\u95ee\u9898\uff1a\u9879\u76ee\u7c92\u5ea6\u7684\u6743\u9650\u7ba1\u7406\u8f83\u4e3a\u56f0\u96be\uff0c\u56e2\u961f\u6210\u5458\u53ef\u4ee5\u8bbf\u95ee\u5230\u4e0e\u81ea\u5df1\u65e0\u5173\u7684\u4ee3\u7801\uff0c\u5bb9\u6613\u4ea7\u751f\u975e owner \u7ba1\u7406\u8005\u7684\u6539\u52a8\u98ce\u9669\u3002\u4f7f\u7528 Monorepo \u4e5f\u5c31\u610f\u5473\u7740\u63a5\u53d7\u4e86\u4f7f\u7528\u56e2\u961f\u95f4\u7684\u4ee3\u7801\u5171\u4eab\uff0c\u5982\u679c\u5bf9\u4ee3\u7801\u9694\u79bb\u6709\u5f3a\u8981\u6c42\uff0cMonorepo \u7684\u65b9\u6848\u53ef\u80fd\u5c31\u4e0d\u5408\u9002\u4e86\u3002"}),"\n",(0,i.jsx)(e.li,{children:"Monorepo \u53ef\u80fd\u968f\u7740\u65f6\u95f4\u63a8\u79fb\u53d8\u5f97\u5e9e\u5927\u548c\u590d\u6742\uff0c\u5bfc\u81f4\u6784\u5efa\u65f6\u95f4\u589e\u957f\u548c\u7ba1\u7406\u56f0\u96be\uff0cgit clone\u3001pull \u7684\u6210\u672c\u589e\u52a0"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u5305\u7ba1\u7406\u5de5\u5177",children:"\u5305\u7ba1\u7406\u5de5\u5177"}),"\n",(0,i.jsx)(e.p,{children:"npm\u3001yarn\u3001pnpm \u7b49\u662f\u7528\u6765\u7ba1\u7406\u9879\u76ee\u4f9d\u8d56\u3001\u53d1\u5e03\u5305\u3001\u5b89\u88c5\u4f9d\u8d56\u7684\u5de5\u5177\uff0c\u5b83\u4eec\u90fd\u63d0\u4f9b\u4e86\u5bf9\u5de5\u4f5c\u533a\uff08workspace\uff09\u7684\u652f\u6301\uff0c\u5141\u8bb8\u5728\u5355\u4e2a\u4ee3\u7801\u5e93\u4e2d\u7ba1\u7406\u591a\u4e2a\u9879\u76ee\u6216\u5305\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u8fd9\u4e9b\u5305\u7ba1\u7406\u5de5\u5177\u4e0e monorepo \u7684\u5173\u7cfb\u5728\u4e8e\u5b83\u4eec\u53ef\u4ee5\u4e3a monorepo ",(0,i.jsx)(e.strong,{children:"\u63d0\u4f9b\u4f9d\u8d56\u5b89\u88c5\u4e0e\u4f9d\u8d56\u7ba1\u7406\u7684\u652f\u6301"}),"\uff0c\u501f\u52a9\u81ea\u8eab\u5bf9 workspace \u7684\u652f\u6301\uff0c\u5141\u8bb8\u5728 monorepo \u4e2d\u7684\u4e0d\u540c\u5b50\u9879\u76ee\u4e4b\u95f4",(0,i.jsx)(e.strong,{children:"\u5171\u4eab\u4f9d\u8d56\u9879"}),"\uff0c\u5e76\u63d0\u4f9b\u4e00\u79cd\u7ba1\u7406\u8fd9\u4e9b\u5171\u4eab\u4f9d\u8d56\u9879\u7684\u65b9\u5f0f\uff0c\u8fd9\u53ef\u4ee5\u7b80\u5316\u4f9d\u8d56\u9879\u7ba1\u7406\u548c\u6784\u5efa\u8fc7\u7a0b\uff0c\u5e76\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u3002"]}),"\n",(0,i.jsxs)(e.h5,{id:"\u5728\u6267\u884c-npm-install-\u7684\u65f6\u5019\u53d1\u751f\u4e86\u4ec0\u4e48",children:["\u5728\u6267\u884c ",(0,i.jsx)(e.code,{children:"npm install"})," \u7684\u65f6\u5019\u53d1\u751f\u4e86\u4ec0\u4e48\uff1f"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u9996\u5148\u5b89\u88c5\u7684\u4f9d\u8d56\u90fd\u4f1a\u5b58\u653e\u5728\u6839\u76ee\u5f55\u7684 node_modules,\u9ed8\u8ba4\u91c7\u7528\u6241\u5e73\u5316\u7684\u65b9\u5f0f\u5b89\u88c5\uff0c\u6392\u5e8f\u89c4\u5219: .bin \u7b2c\u4e00\u4e2a\u7136\u540e@\u7cfb\u5217\uff0c\u518d\u7136\u540e\u6309\u7167\u9996\u5b57\u6bcd\u6392\u5e8f abcd \u7b49\uff0c\u4f7f\u7528\u7b97\u6cd5:",(0,i.jsx)(e.strong,{children:"\u5e7f\u5ea6\u4f18\u5148\u904d\u5386"}),"\uff0c"]}),"\n",(0,i.jsx)(e.li,{children:"\u904d\u5386\u4f9d\u8d56\u6811\u65f6\uff0cnpm \u4f1a\u9996\u5148\u5904\u7406\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684\u4f9d\u8d56\uff0c\u7136\u540e\u9010\u5c42\u5904\u7406\u6bcf\u4e2a\u4f9d\u8d56\u5305\u7684\u4f9d\u8d56\uff0c\u76f4\u5230\u6240\u6709\u4f9d\u8d56\u90fd\u88ab\u5904\u7406\u5b8c\u6bd5\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u5904\u7406\u6bcf\u4e2a\u4f9d\u8d56\u65f6\uff0cnpm \u4f1a\u68c0\u67e5\u8be5\u4f9d\u8d56\u7684\u7248\u672c\u53f7\u662f\u5426\u7b26\u5408\u4f9d\u8d56\u6811\u4e2d\u5176\u4ed6\u4f9d\u8d56\u7684\u7248\u672c\u8981\u6c42\uff0c\u5982\u679c\u4e0d\u7b26\u5408\uff0c\u5219\u4f1a\u5c1d\u8bd5\u5b89\u88c5\u9002\u5408\u7684\u7248\u672c"}),"\n"]}),"\n",(0,i.jsx)(e.h5,{id:"package-lockjson-\u6587\u4ef6\u7684\u4f5c\u7528",children:"package-lock.json \u6587\u4ef6\u7684\u4f5c\u7528\uff1f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"version \u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f53\u524d\u5305\u7684\u7248\u672c\u53f7"}),"\n",(0,i.jsx)(e.li,{children:"resolved \u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f53\u524d\u5305\u7684\u4e0b\u8f7d\u5730\u5740"}),"\n",(0,i.jsx)(e.li,{children:"integrity \u7528\u4e8e\u9a8c\u8bc1\u5305\u7684\u5b8c\u6574\u6027"}),"\n",(0,i.jsx)(e.li,{children:"dev \u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f53\u524d\u5305\u662f\u4e00\u4e2a\u5f00\u53d1\u4f9d\u8d56\u5305"}),"\n",(0,i.jsx)(e.li,{children:"bin \u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f53\u524d\u5305\u4e2d\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8def\u5f84\u548c\u540d\u79f0"}),"\n",(0,i.jsx)(e.li,{children:"engines \u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f53\u524d\u5305\u6240\u4f9d\u8d56\u7684 Node.js \u7248\u672c\u8303\u56f4"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["package-lock.json \u4f5c\u7528\u662f",(0,i.jsx)(e.strong,{children:"\u7f13\u5b58"}),"\uff1a"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"name"})," + ",(0,i.jsx)(e.code,{children:"version"})," + ",(0,i.jsx)(e.code,{children:"integrity"})," \u4fe1\u606f\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684 key\uff0c\u8fd9\u4e2a key \u80fd\u627e\u5230\u5bf9\u5e94\u7684",(0,i.jsx)(e.code,{children:"index-v5"}),"\u4e0b\u7684\u7f13\u5b58\u8bb0\u5f55,\u5982\u679c\u53d1\u73b0\u6709\u7f13\u5b58\u8bb0\u5f55\uff0c\u5c31\u4f1a\u627e\u5230 tar \u5305\u7684 hash \u503c\uff0c\u7136\u540e\u5c06\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u89e3\u538b\u5230 node_modules\u3002\uff08",(0,i.jsx)(e.code,{children:"ls ~/.npm/_cacache/index-v5"}),"\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u535a\u5ba2\u7684\u9879\u76ee\u4e2d\uff1anode_modules --\x3e .cache --\x3e terser-webpack-plugin --\x3e index-v5"}),"\n",(0,i.jsx)(e.h5,{id:"npm-run-xxx-\u53d1\u751f\u4e86\u4ec0\u4e48",children:"npm run xxx \u53d1\u751f\u4e86\u4ec0\u4e48\uff1f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8bfb\u53d6 package json \u7684 scripts \u5bf9\u5e94\u7684\u811a\u672c\u547d\u4ee4\uff08\u4ee5 vite \u811a\u672c\u4e3a\u4f8b\uff09"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u67e5\u627e\u987a\u5e8f\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5148\u4ece\u5f53\u524d\u9879\u76ee\u7684 node_modules/.bin \u53bb\u67e5\u627e\u53ef\u6267\u884c\u547d\u4ee4 vite(node_modules --\x3e .bin --\x3e vite \u6587\u4ef6)"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u6ca1\u627e\u5230\u5c31\u53bb\u5168\u5c40\u7684 node_modules \u53bb\u627e\u53ef\u6267\u884c\u547d\u4ee4 vite"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u8fd8\u6ca1\u627e\u5230\u5c31\u53bb\u73af\u5883\u53d8\u91cf\u67e5\u627e"}),"\n",(0,i.jsx)(e.li,{children:"\u518d\u627e\u4e0d\u5230\u5c31\u8fdb\u884c\u62a5\u9519"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u67e5\u627e\u5230\u7684\u6587\u4ef6\u6709\u4e09\u79cd\uff08\u53ef\u6267\u884c\u547d\u4ee4\u517c\u5bb9\u5404\u5e73\u53f0\uff09\uff1a.sh \u6587\u4ef6 / .cmd \u6587\u4ef6 / .ps1 \u6587\u4ef6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:".sh \u6587\u4ef6\u662f\u7ed9 Linux unix Macos \u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:".cmd \u7ed9 windows \u7684 cmd \u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:".ps1 \u7ed9 windows \u7684 powerShell \u4f7f\u7528"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"npm \u751f\u547d\u5468\u671f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'    "predev": "node prev.js",\n    "dev": "node index.js",\n    "postdev": "node post.js"\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c npm run dev \u547d\u4ee4\u65f6 :"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"step1\uff1a\u6267\u884c predev"}),"\n",(0,i.jsx)(e.li,{children:"step2: dev \u547d\u4ee4"}),"\n",(0,i.jsx)(e.li,{children:"\u6267\u884c postdev"}),"\n"]}),"\n",(0,i.jsx)(e.h5,{id:"workspace-\u5de5\u4f5c\u533a",children:"Workspace \u5de5\u4f5c\u533a"}),"\n",(0,i.jsx)(e.p,{children:"\u5305\u7ba1\u7406\u5de5\u5177\u901a\u8fc7 workspace \u529f\u80fd\u6765\u652f\u6301 Monorepo \u6a21\u5f0f\u3002Workspace \u662f\u6307\u5728\u4e00\u4e2a\u4ee3\u7801\u5e93\u4e2d\u7ba1\u7406\u591a\u4e2a\u76f8\u5173\u9879\u76ee\u6216\u6a21\u5757\u7684\u80fd\u529b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u2753 \u5305\u7ba1\u7406\u5de5\u5177\u5982\u4f55\u5b9e\u73b0 workspace \u7684\u652f\u6301"}),"\n",(0,i.jsx)(e.p,{children:"1\ufe0f\u20e3 \u4ee3\u7801\u7ed3\u6784\u7ec4\u7ec7\uff1a\u5728 Monorepo \u4e2d\uff0c\u4e0d\u540c\u7684\u9879\u76ee\u6216\u6a21\u5757\u901a\u5e38\u4f4d\u4e8e\u540c\u4e00\u4e2a\u4ee3\u7801\u5e93\u7684\u4e0d\u540c\u76ee\u5f55\u4e2d\u3002\u5305\u7ba1\u7406\u5de5\u5177\u901a\u8fc7\u8bc6\u522b\u5e76\u7ba1\u7406\u8fd9\u4e9b\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4ee5\u5c06\u5b83\u4eec\u4f5c\u4e3a\u72ec\u7acb\u7684\u9879\u76ee\u6216\u6a21\u5757\u8fdb\u884c\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"2\ufe0f\u20e3 \u5171\u4eab\u4f9d\u8d56\uff1aMonorepo \u4e2d\u7684\u4e0d\u540c\u9879\u76ee\u6216\u6a21\u5757\u53ef\u4ee5\u5171\u4eab\u76f8\u540c\u7684\u4f9d\u8d56\u9879\u3002\u5305\u7ba1\u7406\u5de5\u5177\u53ef\u4ee5\u901a\u8fc7\u5728\u6839\u76ee\u5f55\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u5171\u4eab\u7684\u4f9d\u8d56\u9879\u5217\u8868\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u4f9d\u8d56\u9879\u5728\u6240\u6709\u9879\u76ee\u6216\u6a21\u5757\u4e2d\u90fd\u53ef\u7528\u3002"}),"\n",(0,i.jsx)(e.p,{children:"3\ufe0f\u20e3 \u4ea4\u53c9\u5f15\u7528\uff1a\u5728 Monorepo \u4e2d\uff0c\u4e0d\u540c\u9879\u76ee\u6216\u6a21\u5757\u4e4b\u95f4\u53ef\u80fd\u5b58\u5728\u76f8\u4e92\u5f15\u7528\u7684\u60c5\u51b5\u3002\u5305\u7ba1\u7406\u5de5\u5177\u9700\u8981\u5904\u7406\u8fd9\u4e9b\u4ea4\u53c9\u5f15\u7528\uff0c\u4ee5\u786e\u4fdd\u6b63\u786e\u89e3\u6790\u548c\u6784\u5efa\u9879\u76ee\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002"}),"\n",(0,i.jsx)(e.p,{children:"4\ufe0f\u20e3 \u7248\u672c\u7ba1\u7406\uff1aMonorepo \u4e2d\u7684\u4e0d\u540c\u9879\u76ee\u6216\u6a21\u5757\u53ef\u80fd\u5177\u6709\u4e0d\u540c\u7684\u7248\u672c\u3002\u5305\u7ba1\u7406\u5de5\u5177\u9700\u8981\u80fd\u591f\u7ba1\u7406\u548c\u8ddf\u8e2a\u8fd9\u4e9b\u7248\u672c\uff0c\u5e76\u786e\u4fdd\u6b63\u786e\u5730\u5b89\u88c5\u548c\u4f7f\u7528\u9002\u5f53\u7684\u7248\u672c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"5\ufe0f\u20e3 \u6784\u5efa\u548c\u6d4b\u8bd5\uff1a\u5305\u7ba1\u7406\u5de5\u5177\u9700\u8981\u652f\u6301\u5728 Monorepo \u4e2d\u8fdb\u884c\u589e\u91cf\u6784\u5efa\u548c\u6d4b\u8bd5\u3002\u8fd9\u610f\u5473\u7740\u53ea\u6709\u53d1\u751f\u66f4\u6539\u7684\u9879\u76ee\u6216\u6a21\u5757\u4f1a\u91cd\u65b0\u6784\u5efa\u548c\u6d4b\u8bd5\uff0c\u800c\u4e0d\u9700\u8981\u91cd\u65b0\u6784\u5efa\u548c\u6d4b\u8bd5\u6574\u4e2a\u4ee3\u7801\u5e93\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"-\u4e3a\u4ec0\u4e48-pnpmmonorepo-\u662f\u76ee\u524d\u7684\u6700\u4f73\u5b9e\u8df5",children:"\u2753 \u4e3a\u4ec0\u4e48 pnpm+Monorepo \u662f\u76ee\u524d\u7684\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsx)(e.p,{children:"\u9996\u5148\u6765\u770b\u770b npm \u4e0e yarn \u5b58\u5728\u7684\u95ee\u9898\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e0d\u540c\u9879\u76ee\u4e2d\u91cd\u590d\u7684\u5305\u4f1a\u88ab\u91cd\u590d\u4e0b\u8f7d\uff0c\u5bf9\u78c1\u76d8\u7a7a\u95f4\u7684\u5229\u7528\u7387\u4e0d\u8db3"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6241\u5e73\u5316\u4f9d\u8d56\u5b58\u5728\u4f9d\u8d56\u975e\u6cd5\u8bbf\u95ee\u7684\u95ee\u9898\uff1a\u9879\u76ee\u4ee3\u7801\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u6ca1\u6709\u88ab\u5b9a\u4e49\u5728 package.json \u4e2d\u7684\u5305\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u6211\u4eec\u5e38\u8bf4\u7684\u5e7d\u7075\u4f9d\u8d56\uff08\u5b89\u88c5\u7684\u5305\u53ef\u80fd\u4f9d\u8d56\u4e86\u4e00\u4e9b\u5305,\u800c\u4f9d\u8d56\u7684\u8fd9\u4e9b\u5305\u53c8\u4f1a\u4f9d\u8d56\u5176\u5b83\u5305...npm \u4e0e yarn \u662f\u628a\u8fd9\u4e9b\u5305\u6241\u5e73\u653e\u5165 node_modules \u4e0b,\u8fd9\u4e5f\u5c31\u5bfc\u81f4 node_modules \u91cc\u51fa\u73b0\u4e86\u8fd9\u4e48\u591a\u5305\uff09\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u5e7d\u7075\u4f9d\u8d56\u4f1a\u5e26\u6765\u54ea\u4e9b\u95ee\u9898\uff1f\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5047\u8bbe\u5b89\u88c5\u4e00\u4e2a\u4f9d\u8d56\u5305 A1,\u800c A1 \u4f9d\u8d56 B1,\u5982\u679c\u9879\u76ee\u65f6\u9700\u8981\u7528\u5230 B1,B1 \u5728\u6ca1\u6709\u5b89\u88c5\u7684\u60c5\u51b5\u88ab\u76f4\u63a5\u4f7f\u7528\u3002\u5982\u679c\u4f9d\u8d56\u5305 A1 \u5347\u7ea7\u4e3a A2,\u800c A2 \u9700\u8981\u4f9d\u8d56\u5347\u7ea7\u7248\u7684 B2 \u6216\u8005\u4e0d\u518d\u9700\u8981\u4f9d\u8d56 B1,\u8fd9\u65f6\u5019\u542f\u52a8\u9879\u76ee\u95ee\u9898\u5c31\u51fa\u73b0\u4e86,\u4ee3\u7801\u53ef\u80fd\u5c31\u51fa B1 \u7248\u672c\u4e0d\u517c\u5bb9\u6216\u8005 B1 \u4f9d\u8d56\u4e22\u5931\u95ee\u9898!"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u2753pnpm \u662f\u5982\u4f55\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u7684"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"pnpm \u4f7f\u7528\u786c\u8fde\u63a5\u7684\u65b9\u5f0f\u8282\u7ea6\u78c1\u76d8\u7a7a\u95f4\u5229\u7528\u7387\u3001\u91c7\u7528\u865a\u62df\u5b58\u50a8\u76ee\u5f55+\u8f6f\u8fde\u63a5\u89e3\u51b3\u5e7d\u7075\u4f9d\u8d56"})}),"\n",(0,i.jsx)(e.p,{children:"\u786c\u8fde\u63a5\uff1a\u7535\u8111\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u6587\u4ef6\u5e73\u7b49\u7684\u5171\u4eab\u540c\u4e00\u4e2a\u6587\u4ef6\u5b58\u50a8\u5355\u5143\uff0c\u5982\u679c\u5b58\u5728\u6539\u52a8\uff0c\u90a3\u4e48\u591a\u4e2a\u6587\u4ef6\u4f1a\u66f4\u65b0\u6539\u52a8\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8f6f\u94fe\u63a5\uff08\u7b26\u53f7\u8fde\u63a5\uff09\uff1a \u5305\u542b\u4e00\u6761\u4ee5\u7edd\u5bf9\u8def\u5f84\u6216\u76f8\u5bf9\u8def\u5f84\u7684\u5f62\u5f0f\u6307\u5411\u5176\u4ed6\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u7684\u5f15\u7528\u3002\u8f6f\u94fe\u63a5\u6240\u4ea7\u751f\u7684\u6587\u4ef6\u662f\u65e0\u6cd5\u66f4\u6539\u7684\uff0c\u5b83\u53ea\u662f\u5b58\u50a8\u4e86\u76ee\u6807\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u5e76\u6839\u636e\u8be5\u8def\u5f84\u53bb\u8bbf\u95ee\u5bf9\u5e94\u7684\u6587\u4ef6\u3002"}),"\n",(0,i.jsx)(e.h5,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u4ee3\u7801\u4ed3\u7684\u6839\u76ee\u5f55\u4e0b\u5b58\u6709 pnpm-workspace.yaml \u6587\u4ef6\u6307\u5b9a\u54ea\u4e9b\u76ee\u5f55\u4f5c\u4e3a\u72ec\u7acb\u7684\u5de5\u4f5c\u7a7a\u95f4\uff0c\u8fd9\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u5b50\u6a21\u5757\u6216\u8005 npm \u5305\u3002"}),"\n",(0,i.jsx)(e.p,{children:"'packages/*': packages \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5b50\u76ee\u5f55\u90fd\u4f1a\u88ab\u89c6\u4e3a\u72ec\u7acb\u7684\u6a21\u5757"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"vue\u6e90\u7801\u4e2d\u7684\u6a21\u5757",src:r(86162).A+"",width:"1426",height:"1156"})}),"\n",(0,i.jsx)(e.p,{children:"pnpm \u5e76\u4e0d\u662f\u901a\u8fc7\u76ee\u5f55\u540d\u79f0\uff0c\u800c\u662f\u901a\u8fc7\u76ee\u5f55\u4e0b package.json \u6587\u4ef6\u7684 name \u5b57\u6bb5\u6765\u8bc6\u522b\u4ed3\u5e93\u5185\u7684\u5305\u4e0e\u6a21\u5757\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"vue\u6e90\u7801\u793a\u4f8b",src:r(81694).A+"",width:"2206",height:"1516"})}),"\n",(0,i.jsx)(e.p,{children:"1\ufe0f\u20e3 \u4e3a\u6307\u5b9a\u6a21\u5757\u5b89\u88c5\u5916\u90e8\u4f9d\u8d56"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"// \u4e3a a \u5305\u5b89\u88c5 lodash\npnpm --filter a i -S lodash // \u751f\u4ea7\u4f9d\u8d56\npnpm --filter a i -D lodash // \u5f00\u53d1\u4f9d\u8d56\n"})}),"\n",(0,i.jsx)(e.p,{children:"2\ufe0f\u20e3 \u5185\u90e8\u6a21\u5757\u7684\u76f8\u4e92\u4f9d\u8d56"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"// \u6307\u5b9a a \u6a21\u5757\u4f9d\u8d56\u4e8e b \u6a21\u5757\npnpm --filter a i -S b\n"})}),"\n",(0,i.jsx)(e.p,{children:"a/package.json"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n  "name": "a",\n  // ...\n  "dependencies": {\n    "b": "workspace:^"\n  }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5b9e\u9645\u53d1\u5e03 npm \u5305\u65f6\uff0cworkspace:^ \u4f1a\u88ab\u66ff\u6362\u6210\u5185\u90e8\u6a21\u5757 b \u7684\u5bf9\u5e94\u7248\u672c\u53f7(\u5bf9\u5e94 package.json \u4e2d\u7684 version \u5b57\u6bb5)\u3002\u66ff\u6362\u89c4\u5f8b\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n  "dependencies": {\n    "a": "workspace:*", // \u56fa\u5b9a\u7248\u672c\u4f9d\u8d56\uff0c\u88ab\u8f6c\u6362\u6210 x.x.x\n    "b": "workspace:~", // minor \u7248\u672c\u4f9d\u8d56\uff0c\u5c06\u88ab\u8f6c\u6362\u6210 ~x.x.x\n    "c": "workspace:^" // major \u7248\u672c\u4f9d\u8d56\uff0c\u5c06\u88ab\u8f6c\u6362\u6210 ^x.x.x\n  }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"2proxy",children:"2.proxy"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u7840\u4f7f\u7528",children:"\u57fa\u7840\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"// target \u8981\u4f7f\u7528 Proxy \u5305\u88c5\u7684\u76ee\u6807\u5bf9\u8c61\uff08\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5305\u62ec\u539f\u751f\u6570\u7ec4\uff0c\u51fd\u6570\uff0c\u751a\u81f3\u53e6\u4e00\u4e2a\u4ee3\u7406)\n// handler \u4e00\u4e2a\u901a\u5e38\u4ee5\u51fd\u6570\u4f5c\u4e3a\u5c5e\u6027\u7684\u5bf9\u8c61\uff0c\u7528\u6765\u5b9a\u5236\u62e6\u622a\u884c\u4e3a\nconst proxy = new Proxy(target, handler);\n"})}),"\n",(0,i.jsx)(e.h4,{id:"proxy-\u7684\u4f5c\u7528",children:"proxy \u7684\u4f5c\u7528"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62e6\u622a\u548c\u76d1\u89c6\u5916\u90e8\u5bf9\u5bf9\u8c61\u7684\u8bbf\u95ee"}),"\n",(0,i.jsx)(e.li,{children:"\u964d\u4f4e\u51fd\u6570\u6216\u7c7b\u7684\u590d\u6742\u5ea6"}),"\n",(0,i.jsx)(e.li,{children:"\u5728\u590d\u6742\u64cd\u4f5c\u524d\u5bf9\u64cd\u4f5c\u8fdb\u884c\u6821\u9a8c\u6216\u5bf9\u6240\u9700\u8d44\u6e90\u8fdb\u884c\u7ba1\u7406"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u53c2\u6570-handler-\u5bf9\u8c61\u7684\u5e38\u7528\u65b9\u6cd5",children:"\u53c2\u6570 handler \u5bf9\u8c61\u7684\u5e38\u7528\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u9645\u4e0a handler \u672c\u8eab\u5c31\u662f ES6 \u6240\u65b0\u8bbe\u8ba1\u7684\u4e00\u4e2a\u5bf9\u8c61.\u5b83 \u7684\u4f5c\u7528\u5c31\u662f\u7528\u6765 \u81ea\u5b9a\u4e49\u4ee3\u7406\u5bf9\u8c61\u7684\u5404\u79cd\u53ef\u4ee3\u7406\u64cd\u4f5c \u3002\u5b83\u672c\u8eab\u4e00\u5171\u6709 13 \u4e2d\u65b9\u6cd5,\u6bcf\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u4ee3\u7406\u4e00\u79cd \u64cd\u4f5c.\u5176 13 \u79cd\u65b9\u6cd5\u5982\u4e0b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bfb\u53d6\u4ee3\u7406\u5bf9\u8c61\uff1a",(0,i.jsx)(e.code,{children:"handler.getPrototypeOf()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbe\u7f6e\u4ee3\u7406\u5bf9\u8c61\u7684\u539f\u578b\uff1a",(0,i.jsx)(e.code,{children:"handler.setPrototypeOf()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5224\u65ad\u4ee3\u7406\u5bf9\u8c61\u662f\u5426\u53ef\u6269\u5c55\uff1a",(0,i.jsx)(e.code,{children:"handler.isExtensible()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbe\u7f6e\u4ee3\u7406\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff1a",(0,i.jsx)(e.code,{children:"handler.preventExtensions()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61\u7279\u5b9a\u5c5e\u6027\u7684\u5c5e\u6027\u63cf\u8ff0\uff1a",(0,i.jsx)(e.code,{children:"handler.getOwnPropertyDescriptor(proxy,keyName)"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5b9a\u4e49\u4ee3\u7406\u5bf9\u8c61\u5c5e\u6027\u7684\u5c5e\u6027\u63cf\u8ff0\uff1a",(0,i.jsx)(e.code,{children:"handler.defineProperty()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5224\u65ad\u4ee3\u7406\u5bf9\u8c61\u662f\u5426\u62e5\u6709\u67d0\u4e2a\u5c5e\u6027\uff1a",(0,i.jsx)(e.code,{children:"handler.has()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bfb\u53d6\u4ee3\u7406\u5bf9\u8c61\u7684\u67d0\u4e2a\u5c5e\u6027\uff1a",(0,i.jsx)(e.code,{children:"handler.get()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u7ed9\u4ee3\u7406\u5bf9\u8c61\u7684\u67d0\u4e2a\u5c5e\u6027\u8d4b\u503c\uff1a",(0,i.jsx)(e.code,{children:"handler.set()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u5220\u9664\u4ee3\u7406\u5bf9\u8c61\u7684\u67d0\u4e2a\u5c5e\u6027\uff1a",(0,i.jsx)(e.code,{children:"handler.deleteProperty()\t"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61\u7684\u6240\u6709\u5c5e\u6027\u952e\uff1a",(0,i.jsx)(e.code,{children:"handler.ownKeys()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8c03\u7528\u4e00\u4e2a\u76ee\u6807\u5bf9\u8c61\u4e3a\u51fd\u6570\u7684\u4ee3\u7406\u5bf9\u8c61\uff1a",(0,i.jsx)(e.code,{children:"handler.apply()"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u7ed9\u4e00\u4e2a\u76ee\u6807\u5bf9\u8c61\u4e3a\u6784\u9020\u51fd\u6570\u7684\u4ee3\u7406\u5bf9\u8c61\u6784\u9020\u5b9e\u4f8b\uff1a",(0,i.jsx)(e.code,{children:"handler.construct()"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Object.getOwnPropertyNames()"})," \u65b9\u6cd5\u548c ",(0,i.jsx)(e.code,{children:"Object.getOwnPropertySymbols()"})," \u65b9\u6cd5\u7684\u6355\u6349\u5668\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u3010 \u8865\u5145 \ud83d\udca1\u3011"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Object.getOwnPropertyNames"})," \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u6210\u5458\u662f\u53c2\u6570\u5bf9\u8c61\u81ea\u8eab\u7684\u5168\u90e8\u5c5e\u6027\u7684\u5c5e\u6027\u540d\uff0c\u4e0d\u7ba1\u8be5\u5c5e\u6027\u662f\u5426\u53ef\u904d\u5386\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Object.keys"})," \u53ea\u8fd4\u56de\u5bf9\u8c61\u81ea\u8eab\u7684\u53ef\u904d\u5386\u5c5e\u6027\u7684\u5168\u90e8\u5c5e\u6027\u540d\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Object.getOwnPropertySymbols"})," \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u7ed9\u5b9a\u5bf9\u8c61\u81ea\u8eab\u7684\u6240\u6709 Symbol \u5c5e\u6027\u7684\u6570\u7ec4\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"handler.apply()"})}),"\n",(0,i.jsx)(e.p,{children:"\u51fd\u6570\u8c03\u7528\u64cd\u4f5c\u7684\u6355\u6349\u5668\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"handler.construct()"})}),"\n",(0,i.jsx)(e.p,{children:"new \u64cd\u4f5c\u7b26\u7684\u6355\u6349\u5668"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u53ef\u64a4\u6d88\u7684-proxy\u5e38\u7528\u4e8e\u5b8c\u5168\u5c01\u95ed\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee",children:"\u53ef\u64a4\u6d88\u7684 Proxy(\u5e38\u7528\u4e8e\u5b8c\u5168\u5c01\u95ed\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee)"}),"\n",(0,i.jsxs)(e.p,{children:["\u521b\u5efa\u4e00\u4e2a\u53ef\u64a4\u9500\u7684\u4ee3\u7406\u5bf9\u8c61:",(0,i.jsx)(e.code,{children:"Proxy.revocable(target, handler)"})]}),"\n",(0,i.jsxs)(e.p,{children:["\u8be5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5176\u7ed3\u6784\u4e3a\uff1a ",(0,i.jsx)(e.code,{children:'{"proxy": proxy, "revoke": revoke}'})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"proxy \u8868\u793a\u65b0\u751f\u6210\u7684\u4ee3\u7406\u5bf9\u8c61\u672c\u8eab\uff0c\u548c\u7528\u4e00\u822c\u65b9\u5f0f new Proxy(target, handler) \u521b\u5efa\u7684\u4ee3\u7406\u5bf9\u8c61\u6ca1\u4ec0\u4e48\u4e0d\u540c\uff0c\u53ea\u662f\u5b83\u53ef\u4ee5\u88ab\u64a4\u9500\u6389\u3002"}),"\n",(0,i.jsx)(e.li,{children:"revoke \u64a4\u9500\u65b9\u6cd5\uff0c\u8c03\u7528\u7684\u65f6\u5019\u4e0d\u9700\u8981\u52a0\u4efb\u4f55\u53c2\u6570\uff0c\u5c31\u53ef\u4ee5\u64a4\u9500\u6389\u548c\u5b83\u4e00\u8d77\u751f\u6210\u7684\u90a3\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const target = `{ name: 'vuejs' }`;\nconst `{ proxy, revoke }` = Proxy.revocable(target, handler);\nproxy.name; // \u6b63\u5e38\u53d6\u503c\u8f93\u51fa vuejs\nrevoke(); // \u53d6\u503c\u5b8c\u6210\u5bf9proxy\u8fdb\u884c\u5c01\u95ed\uff0c\u64a4\u6d88\u4ee3\u7406\nproxy.name; // TypeError: Revoked\n"})}),"\n",(0,i.jsx)(e.h4,{id:"proxy-\u4f7f\u7528\u573a\u666f\u793a\u4f8b",children:"proxy \u4f7f\u7528\u573a\u666f\u793a\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:"1\ufe0f\u20e3 \u5b9e\u73b0\u4e00\u4e2a\u903b\u8f91\u5206\u79bb\u7684\u6570\u636e\u683c\u5f0f\u9a8c\u8bc1\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const target = {\n  _id: '1024',\n  name: 'vuejs'\n};\n\nconst validators = {\n  name(val) {\n    return typeof val === 'string';\n  },\n  _id(val) {\n    return typeof val === 'number' && val > 1024;\n  }\n};\n\nconst createValidator = (target, validator) => {\n  return new Proxy(target, {\n    _validator: validator,\n    set(target, propkey, value, proxy) {\n      let validator = this._validator[propkey](value);\n      if (validator) {\n        return Reflect.set(target, propkey, value, proxy);\n      } else {\n        throw Error(`Cannot set $`{propkey}` to $`{value}`. Invalid type.`);\n      }\n    }\n  });\n};\n\nconst proxy = createValidator(target, validators);\n\nproxy.name = 'vue-js.com'; // vue-js.com\nproxy.name = 10086; // Uncaught Error: Cannot set name to 10086. Invalid type.\nproxy._id = 1025; // 1025\nproxy._id = 22; // Uncaught Error: Cannot set _id to 22. Invalid type\n"})}),"\n",(0,i.jsx)(e.p,{children:"2\ufe0f\u20e3 \u5b9e\u73b0\u79c1\u6709\u5c5e\u6027\u62e6\u622a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const target = {\n  _id: '1024',\n  name: 'vuejs'\n};\n\nconst proxy = new Proxy(target, {\n  get(target, propkey, proxy) {\n    if (propkey[0] === '_') {\n      throw Error(`$`{propkey}` is restricted`);\n    }\n    return Reflect.get(target, propkey, proxy);\n  },\n  set(target, propkey, value, proxy) {\n    if (propkey[0] === '_') {\n      throw Error(`$`{propkey}` is restricted`);\n    }\n    return Reflect.set(target, propkey, value, proxy);\n  }\n});\n\nproxy.name; // vuejs\nproxy._id; // Uncaught Error: _id is restricted\nproxy._id = '1025'; // Uncaught Error: _id is restricted\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3objectdefineproperty",children:"3.Object.defineProperty"}),"\n",(0,i.jsx)(e.h4,{id:"\u57fa\u7840\u4f7f\u7528-1",children:"\u57fa\u7840\u4f7f\u7528"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"Object.defineProperty(obj, prop, descriptor)"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"obj \u8981\u5b9a\u4e49\u5c5e\u6027\u7684\u5bf9\u8c61"}),"\n",(0,i.jsx)(e.li,{children:"prop \u8981\u5b9a\u4e49\u6216\u4fee\u6539\u7684\u5c5e\u6027\u7684\u540d\u79f0\u6216 Symbol"}),"\n",(0,i.jsx)(e.li,{children:"descriptor \u8981\u5b9a\u4e49\u6216\u4fee\u6539\u7684\u5c5e\u6027\u63cf\u8ff0\u7b26"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const obj = `{}`;\nObject.defineProperty(obj, 'a', {\n  value: 1,\n  writable: false, // \u662f\u5426\u53ef\u5199\n  configurable: false, // \u662f\u5426\u53ef\u914d\u7f6e\n  enumerable: false // \u662f\u5426\u53ef\u679a\u4e3e\n});\n\n// \u4e0a\u9762\u7ed9\u4e86\u4e09\u4e2afalse, \u4e0b\u9762\u7684\u76f8\u5173\u64cd\u4f5c\u5c31\u5f88\u5bb9\u6613\u7406\u89e3\u4e86\nobj.a = 2; // \u65e0\u6548\ndelete obj.a; // \u65e0\u6548\nfor (key in obj) {\n  console.log(key); // \u65e0\u6548\n}\n"})}),"\n",(0,i.jsx)(e.h4,{id:"vue2-\u5185\u90e8\u5bf9\u4e8e\u6570\u7ec4\u53d8\u5f02\u7684\u65b9\u6cd5\u5904\u7406",children:"vue2 \u5185\u90e8\u5bf9\u4e8e\u6570\u7ec4\u53d8\u5f02\u7684\u65b9\u6cd5\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u56e0\uff1adefineProperty \u65e0\u6cd5\u68c0\u6d4b\u5230\u5bf9\u8c61\u5c5e\u6027\u7684\u6dfb\u52a0\u548c\u5220\u9664"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const methodsToPatch = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse'\n];\n\nmethodsToPatch.forEach(function (method) {\n  // \u7f13\u5b58\u539f\u751f\u6570\u7ec4\n  const original = arrayProto[method];\n  // def\u4f7f\u7528Object.defineProperty\u91cd\u65b0\u5b9a\u4e49\u5c5e\u6027\n  def(arrayMethods, method, function mutator(...args) {\n    const result = original.apply(this, args); // \u8c03\u7528\u539f\u751f\u6570\u7ec4\u7684\u65b9\u6cd5\n\n    const ob = this.__ob__; // ob\u5c31\u662fobserve\u5b9e\u4f8bobserve\u624d\u80fd\u54cd\u5e94\u5f0f\n    let inserted;\n    switch (method) {\n      // push\u548cunshift\u65b9\u6cd5\u4f1a\u589e\u52a0\u6570\u7ec4\u7684\u7d22\u5f15\uff0c\u4f46\u662f\u65b0\u589e\u7684\u7d22\u5f15\u4f4d\u9700\u8981\u624b\u52a8observe\u7684\n      case 'push':\n      case 'unshift':\n        inserted = args;\n        break;\n      // \u540c\u7406\uff0csplice\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4e3a\u65b0\u589e\u7684\u503c\uff0c\u4e5f\u9700\u8981\u624b\u52a8observe\n      case 'splice':\n        inserted = args.slice(2);\n        break;\n    }\n    // \u5176\u4f59\u7684\u65b9\u6cd5\u90fd\u662f\u5728\u539f\u6709\u7684\u7d22\u5f15\u4e0a\u66f4\u65b0\uff0c\u521d\u59cb\u5316\u7684\u65f6\u5019\u5df2\u7ecfobserve\u8fc7\u4e86\n    if (inserted) ob.observeArray(inserted);\n    // dep\u901a\u77e5\u6240\u6709\u7684\u8ba2\u9605\u8005\u89e6\u53d1\u56de\u8c03\n    ob.dep.notify();\n    return result;\n  });\n});\n"})}),"\n",(0,i.jsx)(e.h2,{id:"vue3-vs-vue2",children:"vue3 vs vue2"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["1.\u6e90\u7801\u4f18\u5316:\u4f7f\u7528 ",(0,i.jsx)(e.strong,{children:"monorepo"})," \u548c ",(0,i.jsx)(e.strong,{children:"ts"})," \u7ba1\u7406\u548c\u5f00\u53d1\u6e90\u7801\uff0c\u63d0\u5347\u4ee3\u7801\u53ef\u7ef4\u62a4\u6027\u3002"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"monorepo \u5c06 vue2 \u7684\u6a21\u5757\u62c6\u5206\u5230\u4e0d\u540c\u7684 package \u4e2d\uff0c\u6bcf\u4e2a package \u6709\u5404\u81ea\u7684 API\u3001\u7c7b\u578b\u5b9a\u4e49\u548c\u6d4b\u8bd5\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(13948).A+"",width:"350",height:"804"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"package \u53ef\u4ee5\u72ec\u7acb vue \u4f7f\u7528\uff0c\u5982\u679c\u7528\u6237\u53ea\u60f3\u4f7f\u7528 vue3 \u7684\u54cd\u5e94\u5f0f\u80fd\u529b\uff0c\u53ef\u5355\u72ec\u4f9d\u8d56\u8fd9\u4e2a\u54cd\u5e94\u5f0f\u5e93\u800c\u4e0d\u7528\u4f9d\u8d56\u6574\u4e2a vue\uff0c\u51cf\u5c0f\u4e86\u5f15\u7528\u5305\u7684\u4f53\u79ef\uff0cvue2 \u65e0\u6cd5\u63d0\u4f9b\u8fd9\u4e2a\u529f\u80fd\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"vue3 \u4e2d\u4f7f\u7528 ts \u91cd\u6784\u4e86\u6574\u4e2a\u9879\u76ee\uff0cvue2 \u4e2d\u4f7f\u7528\u7684 Flow\uff08\u5bf9\u590d\u6742\u573a\u666f\u7684\u7c7b\u578b\u68c0\u67e5\u652f\u6301\u4e0d\u591f\u5b8c\u5584\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"2.\u51cf\u5c11\u4e86\u6e90\u7801\u4f53\u79ef\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u79fb\u9664\u4e00\u4e9b\u51b7\u95e8\u7684 feature\uff08filter \u7b49\uff09"}),"\n",(0,i.jsxs)(e.li,{children:["\u5f15\u5165 tree-shaking \u7684\u6280\u672f\u3002tree-shaking \u4f9d\u8d56 es2015 \u7684\u9759\u6001\u7ed3\u6784\uff08import \u548c export\uff09\uff0c",(0,i.jsx)(e.strong,{children:"\u901a\u8fc7\u7f16\u8bd1\u9636\u6bb5\u7684\u9759\u6001\u5206\u6790\uff0c\u627e\u5230\u6ca1\u6709\u5f15\u5165\u7684\u6a21\u5757\u5e76\u6253\u4e0a\u6807\u8bb0\uff0c\u6ca1\u6709\u5f15\u5165\u7684\u6a21\u5757\u5bf9\u5e94\u7684\u4ee3\u7801\u5c06\u4e0d\u4f1a\u88ab\u6253\u5305"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"3.\u6570\u636e\u52ab\u6301\u4f18\u5316"}),"\n",(0,i.jsx)(e.p,{children:"\u6570\u636e\u52ab\u6301\u66f4\u65b0\uff1a\u5f53\u6570\u636e\u6539\u53d8\u540e\uff0c\u4e3a\u4e86\u81ea\u52a8\u66f4\u65b0 dom\uff0c\u5c31\u5fc5\u987b\u52ab\u6301\u6570\u636e\u7684\u66f4\u65b0\u3002 \u56e0\u4e3a\u5728\u6e32\u67d3 dom \u7684\u65f6\u5019\u8bbf\u95ee\u4e86\u6570\u636e\uff0c\u53ef\u4ee5\u5bf9\u5b83\u8fdb\u884c\u8bbf\u95ee\u52ab\u6301\uff0c\u8fd9\u6837\u5c31\u5728\u5185\u90e8\u5efa\u7acb\u4e86\u4f9d\u8d56\u5173\u7cfb\uff0c\u4e5f\u5c31\u77e5\u9053\u6570\u636e\u5bf9\u5e94\u7684 dom \u662f\u4ec0\u4e48\u4e86\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"vue2 \u4e2d\u4f7f\u7528:"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"Object.defineProperty(data, 'a', {\n  get() {\n    // track\n  },\n  set() {\n    //trigger\n  }\n});\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u203c\ufe0f",(0,i.jsx)(e.code,{children:"Object.defineProperty"})," \u7684\u7f3a\u70b9\uff1a"]}),"\n",(0,i.jsxs)(e.p,{children:["1\ufe0f\u20e3 defineProperty \u662f\u5bf9 \u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u975e\u5bf9\u8c61\u672c\u8eab\u5b9e\u73b0\u6570\u636e\u52ab\u6301\u66f4\u65b0\u9700\u8981\u9884\u5148\u77e5\u9053\u5bf9\u8c61\u7684 key\uff0c\u6240\u4ee5\u65e0\u6cd5\u68c0\u6d4b\u5230\u5bf9\u8c61\u5c5e\u6027\u7684\u6dfb\u52a0\u548c\u5220\u9664\uff0cvue2 \u4e2d\u5bf9\u6b64\u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848\u5206\u522b\u4e3a",(0,i.jsx)(e.code,{children:"$set"}),"\u548c",(0,i.jsx)(e.code,{children:"$delete"}),"\u65b9\u6cd5"]}),"\n",(0,i.jsx)(e.p,{children:"2\ufe0f\u20e3 \u5bf9\u4e8e\u5d4c\u5957\u5c42\u7ea7\u6bd4\u8f83\u6df1\u7684\u5bf9\u8c61\uff0cvue \u65e0\u6cd5\u5728\u8fd0\u884c\u65f6\u5224\u65ad\u5230\u5e95\u8bbf\u95ee\u54ea\u4e2a\u5c5e\u6027\u3002\u6240\u4ee5\u5bf9\u4e8e\u6b64\u7c7b\u5bf9\u8c61\uff0cvue \u91c7\u7528\u9012\u5f52\u904d\u5386\u6bcf\u4e00\u5c42\u7684\u6570\u636e\u5bf9\u8c61\u4e14\u53d8\u6210\u54cd\u5e94\u5f0f\uff0c\u53ef\u80fd\u5b58\u5728\u6027\u80fd\u8d1f\u62c5\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"vue3 \u4e2d\u4f7f\u7528\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"observed = new Proxy(data, {\n  // propkey \u5c5e\u6027\u540d;receiver Proxy \u5b9e\u4f8b\u672c\u8eab\n  get(target, propKey, receiver) {\n    // track\n  },\n  set() {\n    // trigger\n  }\n});\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"Proxy"}),"\u52ab\u6301\u7684\u662f\u6574\u4e2a\u5bf9\u8c61\uff0c\u53ef\u4ee5\u68c0\u6d4b\u5230\u5bf9\u8c61\u5c5e\u6027\u7684\u6dfb\u52a0\u548c\u5220\u9664\u3002\u4f46\u662f",(0,i.jsx)(e.code,{children:"Proxy"}),"\u4e0d\u80fd\u76d1\u542c\u5230\u5185\u90e8\u6df1\u5c42\u6b21\u7684\u5bf9\u8c61\u53d8\u5316\u3002vue \u5bf9\u6b64\u7684\u5904\u7406\u65b9\u5f0f\u662f,\u5728\u5b9e\u9645\u8bbf\u95ee\u5230\u5185\u90e8\u5bf9\u8c61\u65f6\u5728 ",(0,i.jsx)(e.code,{children:"getter"})," \u4e2d\u9012\u5f52\u54cd\u5e94\u5f0f(",(0,i.jsx)(e.code,{children:"Reflect.get"}),")"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"4.\u7f16\u8bd1\u4f18\u5316"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(15086).A+"",width:"986",height:"510"})}),"\n",(0,i.jsxs)(e.p,{children:["vue2 \u7684\u6570\u636e\u66f4\u65b0\u5e76\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3\u7684\u7c92\u5ea6\u662f",(0,i.jsx)(e.strong,{children:"\u7ec4\u4ef6\u7ea7"}),"\u7684\uff0c\u5728\u5355\u7ec4\u4ef6\u5185\u90e8\u9700\u8981\u904d\u5386\u7ec4\u4ef6\u7684 vnode \u6811\uff0c\u5728 diff \u8fc7\u7a0b\u4e2d\uff0cvnode \u6027\u80fd\u548c\u6a21\u677f\u5927\u5c0f\u6b63\u76f8\u5173\uff0c\u5bf9\u4e8e\u9759\u6001\u8282\u70b9\u7684 diff \u5b9e\u9645\u4e0a\u9020\u6210\u4e86\u6027\u80fd\u7684\u6d6a\u8d39\uff0c",(0,i.jsx)(e.strong,{children:"\u7406\u60f3\u72b6\u6001\u4e0b\u5e94\u53ea diff \u52a8\u6001\u8282\u70b9"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["vue3 \u901a\u8fc7\u7f16\u8bd1\u9636\u6bb5\u5bf9\u9759\u6001\u6a21\u677f\u7684\u5206\u6790\uff0c\u7f16\u8bd1\u751f\u6210 Block tree\uff0c\u8fd8\u5305\u542b\u4e86",(0,i.jsx)(e.strong,{children:"\u5bf9 Slot \u7684\u7f16\u8bd1\u4f18\u5316\u3001\u4e8b\u4ef6\u4fa6\u542c\u51fd\u6570\u7684\u7f13\u5b58\u4f18\u5316\uff0c\u5e76\u5728\u8fd0\u884c\u65f6\u91cd\u5199\u4e86 diff \u7b97\u6cd5"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(58046).A+"",width:"1194",height:"210"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"5.\u8bed\u6cd5\u4f18\u5316"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["vue3 \u63d0\u4f9b\u4e86",(0,i.jsx)(e.code,{children:"Composition API"}),",",(0,i.jsx)(e.strong,{children:"\u5c06\u67d0\u4e2a\u903b\u8f91\u5173\u6ce8\u70b9\u76f8\u5173\u7684\u4ee3\u7801\u5168\u90fd\u653e\u5728\u4e00\u4e2a\u51fd\u6570\u91cc\u3002\u5f53\u9700\u8981\u4fee\u6539\u4e00\u4e2a\u529f\u80fd\u65f6\uff0c\u4e0d\u518d\u9700\u8981\u5728\u6587\u4ef6\u4e2d\u53cd\u590d\u5b9a\u4f4d"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"mixins(vue2) vs hook(vue3)"}),"\n",(0,i.jsxs)(e.p,{children:["\u5f53\u9875\u9762\u6587\u4ef6\u4e2d\u591a\u5904\u4f7f\u7528 mixin \u6587\u4ef6\u65f6\uff0c\u5bb9\u6613\u51fa\u73b0",(0,i.jsx)(e.strong,{children:"\u547d\u540d\u51b2\u7a81\uff08props \u3001vaiable\uff09\u548c\u6765\u6e90\u4e0d\u6e05\u6670"}),"\u7684\u95ee\u9898"]}),"\n",(0,i.jsx)(e.p,{children:"hook \u89e3\u51b3\u4e86\u4ee5\u4e0a\u7684\u95ee\u9898"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"6.vue2 \u540e\u671f\u5f00\u59cb\u5f15\u5165 RFC\uff08Request For Comments\uff09\uff0c\u65e8\u5728\u4e3a\u65b0\u529f\u80fd\u8fdb\u5165\u6846\u67b6\u63d0\u4f9b\u4e00\u4e2a\u4e00\u81f4\u4e14\u53d7\u63a7\u7684\u8def\u5f84\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u7248\u672c\u6539\u52a8\u53ef\u63a7\u3002\u5927\u89c4\u6a21\u542f\u7528 RFC\uff0c\u4e86\u89e3\u6bcf\u4e00\u4e2a feature \u91c7\u7528\u6216\u88ab\u5e9f\u5f03\u7684\u524d\u56e0\u540e\u679c\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u7ec4\u4ef6",children:"\u7ec4\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u4e2a\u7ec4\u4ef6\u60f3\u8981\u6e32\u67d3\u751f\u6210 dom \u7684\u51e0\u4e2a\u6b65\u9aa4\uff1a\u521b\u5efa vnode --\x3e \u6e32\u67d3 vnode --\x3e \u751f\u6210 dom"}),"\n",(0,i.jsx)(e.h3,{id:"\u5e94\u7528\u7a0b\u5e8f\u521d\u59cb\u5316",children:"\u5e94\u7528\u7a0b\u5e8f\u521d\u59cb\u5316"}),"\n",(0,i.jsx)(e.p,{children:"\u4e00\u4e2a\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7\u201c\u6a21\u677f+\u5bf9\u8c61\u63cf\u8ff0\u201d\u7684\u65b9\u5f0f\u521b\u5efa\u3002\u6574\u4e2a\u7ec4\u4ef6\u6811\u662f\u7531\u6839\u7ec4\u4ef6\u5f00\u59cb\u6e32\u67d3\uff0c\u4e3a\u627e\u5230\u6839\u7ec4\u4ef6\u7684\u6e32\u67d3\u5165\u53e3\uff0c\u9700\u8981\u4ece\u5e94\u7528\u7a0b\u5e8f\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u5f00\u59cb\u5206\u6790\u3002"}),"\n",(0,i.jsx)(e.p,{children:"vue2 \u521d\u59cb\u5316\u5e94\u7528 vs vue3 \u521d\u59cb\u5316\u5e94\u7528"}),"\n",(0,i.jsxs)(e.p,{children:["\u90fd\u662f\u5c06 App \u7ec4\u4ef6\u6302\u8f7d\u5230 id \u4e3a app \u7684\u8282\u70b9\u4e0a\uff0c\u4f46\u662f vue3 \u5bfc\u5165\u4e86",(0,i.jsx)(e.code,{children:"createApp"}),"\u5165\u53e3\u51fd\u6570\uff0c\u662f vue3 \u5bf9\u5916\u66b4\u9732\u7684\u5185\u90e8\u51fd\u6570\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(46927).A+"",width:"618",height:"232"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5728 vue3 \u6e90\u7801\u4e2d\uff0c\u5b9e\u9645\u8c03\u7528",(0,i.jsx)(e.code,{children:"createApp"}),"\u51fd\u6570\u7684\u662f",(0,i.jsx)(e.code,{children:"createAppAPI"}),"\u65b9\u6cd5\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542b mixins\u3001components\u3001directives\u3001provides \u7b49\u7684\u5bf9\u8c61\uff0c"]}),"\n",(0,i.jsxs)(e.h4,{id:"createapp\u5185\u90e8\u5b9e\u73b0",children:[(0,i.jsx)(e.code,{children:"createApp"}),"\u5185\u90e8\u5b9e\u73b0"]}),"\n",(0,i.jsx)(e.p,{children:"\u2b50\ufe0f \u5728 app \u5bf9\u8c61\u521b\u5efa\u8fc7\u7a0b\u4e2d\uff0cvue \u5229\u7528\u95ed\u5305\u548c\u51fd\u6570\u67ef\u91cc\u5316\uff0c\u5b9e\u73b0\u4e86\u53c2\u6570\u4fdd\u7559"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const createApp = (...args) => {\n  // \u521b\u5efaapp\u5bf9\u8c61\n  // ensureRenderer() \u521b\u5efa\u6e32\u67d3\u5668\n  const app = ensureRenderer().createApp(...args);\n\n  const `{ mount }` = app;\n  // \u91cd\u5199mount\u65b9\u6cd5\uff0c\u6765\u5b8c\u5584web\u5e73\u53f0\u4e0b\u7684\u6e32\u67d3\u903b\u8f91\n  app.mount = (containerOrSelector) => {\n    // \u6807\u51c6\u5316\u5bb9\u5668 containerOrSelector\u53c2\u6570\uff1a\u9009\u62e9\u5668\u5b57\u7b26\u4e32/DOM\u5bf9\u8c61\n    const container = normalizeContainer(containerOrSelector);\n    if (!container) return;\n\n    const component = app._component;\n    // \u5982\u679c\u7ec4\u4ef6\u5bf9\u8c61\u6ca1\u6709\u5b9a\u4e49render\u51fd\u6570\u548ctemplate\u6a21\u677f\uff0c\u5219\u53d6\u5bb9\u6613\u7684innerHTML\u4f5c\u4e3a\u6a21\u677f\u5185\u5bb9\n    if (!isFunction(component) && !component.render && !component.template) {\n      component.template = container.innerHTML;\n    }\n    // \u5728\u6302\u8f7d\u524d\u6e05\u7a7a\u5bb9\u5668\u5185\u5bb9\n    container.innerHTML = '';\n    // \u771f\u6b63\u7684\u6302\u8f7d\n    const proxy = mount(container, false, resolveRootNamespace(container));\n    return proxy;\n  };\n  return app;\n};\n\n// \u6e32\u67d3\u76f8\u5173\u7684\u4e00\u4e9b\u914d\u7f6e\uff0c\u6bd4\u5982\u66f4\u65b0\u5c5e\u6027\u7684\u65b9\u6cd5\uff0c\u64cd\u4f5cdom\u7684\u65b9\u6cd5\u7b49\nconst rendererOptions = {\n  patchProp, // \u5904\u7406props\u5c5e\u6027\n  ...nodeOps //\u5904\u7406dom\u8282\u70b9\u64cd\u4f5c\n};\n\n// \u5ef6\u65f6\u521b\u5efa\u6e32\u67d3\u5668\uff08\u5305\u542b\u5e73\u53f0\u6e32\u67d3\u6838\u5fc3\u903b\u8f91\u7684js\u5bf9\u8c61\uff09\uff0c\u5f53\u7528\u6237\u53ea\u4f9d\u8d56\u54cd\u5e94\u5f0f\u5305\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7tree-shaking\u79fb\u9664\u6838\u5fc3\u6e32\u67d3\u903b\u8f91\u76f8\u5173\u7684\u4ee3\u7801\nlet renderer;\nfunction ensureRenderer() {\n  return renderer || createRenderer(rendererOptions);\n}\n\nexport function createRenderer(options) {\n  return baseCreateRenderer(options);\n}\n\nfunction baseCreateRenderer(options) {\n  const render = (vnode, container, namespace) => {\n    // \u7ec4\u4ef6\u6e32\u67d3\u7684\u6838\u5fc3\u903b\u8f91\n    // vnode diff patch\u5747\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u5b9e\u73b0\n  };\n\n  return {\n    render,\n    createApp: createAppAPI(render)\n  };\n}\n\nfunction createAppAPI(render) {\n  // createApp\u65b9\u6cd5\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a\u6839\u7ec4\u4ef6\u7684\u5bf9\u8c61\u548cprop\n  return function createApp(rootComponent, rootProps = null) {\n    const app = {\n      _component: rootComponent,\n      _props: rootProps,\n      _container: null,\n      _context: context,\n      _instance: null,\n\n      get config() {\n        //...\n      },\n      set config(v) {\n        //...\n      },\n      use(plugin) `{}`,\n      mixin(mixin) `{}`,\n      component(name, component) `{}`,\n      directive(name, directive) `{}`,\n      unmount() `{}`,\n      provide(key, value) `{}`,\n      runWithContext(fn) `{}`,\n\n      // \u6302\u8f7d\u7ec4\u4ef6\n      // \u8be5\u65b9\u6cd5\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u53ef\u8de8\u5e73\u53f0\u7684\u7ec4\u4ef6\u6e32\u67d3\u6d41\u7a0b\uff1a\u5148\u521b\u5efavnode\uff0c\u518d\u6e32\u67d3vnode\n      mount(rootContainer) {\n        // \u521b\u5efa\u6839\u7ec4\u4ef6\u7684vnode\n        const vnode = createVNode(rootComponent, rootProps);\n        // \u5229\u7528\u6e32\u67d3\u5668\u6e32\u67d3vnode;\n        render(vnode, rootContainer);\n        app._container = rootContainer;\n        return vnode.component.proxy;\n      }\n    };\n\n    return app;\n  };\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6838\u5fc3\u6e32\u67d3\u6d41\u7a0b\u521b\u5efa-vnode--\u6e32\u67d3-vnode",children:"\u6838\u5fc3\u6e32\u67d3\u6d41\u7a0b\uff08\u521b\u5efa vnode & \u6e32\u67d3 vnode\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"h\u51fd\u6570\u7684\u5b9a\u4e49",children:"h()\u51fd\u6570\u7684\u5b9a\u4e49"}),"\n",(0,i.jsx)(e.p,{children:"\u8fd4\u56de\u4e00\u4e2a\u201c\u865a\u62df\u8282\u70b9\u201d \uff0c\u901a\u5e38\u7f29\u5199\u4e3a VNode: \u4e00\u4e2a\u666e\u901a\u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u5411 Vue \u63cf\u8ff0\u5b83\u5e94\u8be5\u5728\u9875\u9762\u4e0a\u5448\u73b0\u54ea\u79cd\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u5bf9\u4efb\u4f55\u5b50\u8282\u70b9\u7684\u63cf\u8ff0\u3002\u7528\u4e8e\u624b\u52a8\u7f16\u5199 render"}),"\n",(0,i.jsx)(e.p,{children:"vnode \u672c\u8d28\u4e0a\u662f\u7528\u6765\u63cf\u8ff0 dom \u7684 js \u5bf9\u8c61\uff0c\u5b83\u5728 vue \u4e2d\u53ef\u4ee5\u63cf\u8ff0\u4e0d\u540c\u7c7b\u578b\u7684\u8282\u70b9\uff0c\u6bd4\u5982\u666e\u901a\u5143\u7d20\u8282\u70b9\u3001\u7ec4\u4ef6\u8282\u70b9\u7b49"}),"\n",(0,i.jsx)(e.h3,{id:"h\u51fd\u6570\u7684\u53c2\u6570",children:"h()\u51fd\u6570\u7684\u53c2\u6570"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"type \u5143\u7d20\u7684\u7c7b\u578b"}),"\n",(0,i.jsx)(e.li,{children:"propsOrChildren \u6570\u636e\u5bf9\u8c61, \u8fd9\u91cc\u4e3b\u8981\u8868\u793a(props, attrs, dom props, class \u548c style)"}),"\n",(0,i.jsx)(e.li,{children:"children \u5b50\u8282\u70b9"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"export function h(type: any, propsOrChildren?: any, children?: any): VNode {\n  const l = arguments.length;\n  if (l === 2) {\n    if (isObject(propsOrChildren) && !isArray(propsOrChildren)) {\n      // single vnode without props\n      if (isVNode(propsOrChildren)) {\n        return createVNode(type, null, [propsOrChildren]);\n      }\n      // props without children\n      return createVNode(type, propsOrChildren);\n    } else {\n      // omit props\n      return createVNode(type, null, propsOrChildren);\n    }\n  } else {\n    if (l > 3) {\n      children = Array.prototype.slice.call(arguments, 2);\n    } else if (l === 3 && isVNode(children)) {\n      children = [children];\n    }\n    return createVNode(type, propsOrChildren, children);\n  }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"vnode-\u7684\u7c7b\u578b",children:"vnode \u7684\u7c7b\u578b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u666e\u901a\u5143\u7d20 vnode"}),"\n",(0,i.jsx)(e.li,{children:"\u7ec4\u4ef6 vnode"}),"\n",(0,i.jsx)(e.li,{children:"\u7eaf\u6587\u672c vnode"}),"\n",(0,i.jsx)(e.li,{children:"\u6ce8\u91ca vnode"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u666e\u901a\u5143\u7d20 vnode \u793a\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(13299).A+"",width:"1127",height:"377"})}),"\n",(0,i.jsx)(e.p,{children:"\u7ec4\u4ef6 vnode \u793a\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(19305).A+"",width:"728",height:"343"})}),"\n",(0,i.jsx)(e.h3,{id:"vnode-\u7684\u4f18\u52bf",children:"vnode \u7684\u4f18\u52bf"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f15\u5165 vnode \u53ef\u4ee5\u5c06\u6e32\u67d3\u8fc7\u7a0b\u62bd\u8c61\u5316\uff0c\u4ece\u800c\u4f7f\u7ec4\u4ef6\u7684\u62bd\u8c61\u80fd\u529b\u5f97\u5230\u63d0\u5347"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8de8\u5e73\u53f0\u4f18\u52bf\uff0cpatch vnode \u7684\u8fc7\u7a0b\u4e0d\u540c\u7684\u5e73\u53f0\u53ef\u4ee5\u6709\u81ea\u5df1\u7684\u5b9e\u73b0\uff0c\u57fa\u4e8e vnode \u518d\u505a\u670d\u52a1\u7aef\u6e32\u67d3\uff0cweex \u5e73\u53f0\u3001\u5c0f\u7a0b\u5e8f\u5e73\u53f0\u6e32\u67d3\u4f1a\u5bb9\u6613\u5f88\u591a\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u2753vnode \u6bd4\u624b\u52a8\u64cd\u4f5c dom \u6027\u80fd\u597d\u5417"}),"\n",(0,i.jsx)(e.p,{children:"\u4e0d\u4e00\u5b9a\uff0c\u57fa\u4e8e vnode \u5b9e\u73b0\u7684 MVVM \u6846\u67b6\uff0c\u5728\u6bcf\u6b21 render to vnode \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6e32\u67d3\u7ec4\u4ef6\u4f1a\u6709\u4e00\u5b9a\u7684 js \u8017\u65f6\uff0c\u5c24\u5176\u662f\u5927\u7ec4\u4ef6\uff08\u4f8b\u5982\u6570\u636e\u91cf\u5927\u7684 table \u7ec4\u4ef6\uff09\uff1b\u4e0d\u4ec5\u5982\u6b64\uff0c\u5728 patch vnode \u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e5f\u4f1a\u5b58\u5728\u6027\u80fd\u95ee\u9898\u3002diff \u7b97\u6cd5\u7684\u4f18\u52bf\u5728\u4e8e\u51cf\u5c11 dom \u64cd\u4f5c\uff0c\u4f46\u662f\u65e0\u6cd5\u907f\u514d dom \u64cd\u4f5c"}),"\n",(0,i.jsxs)(e.h3,{id:"\u521b\u5efa-vnodecreatevnode\u5185\u90e8\u5b9e\u73b0",children:["\u521b\u5efa vnode\uff1a",(0,i.jsx)(e.code,{children:"createVNode"}),"\u5185\u90e8\u5b9e\u73b0"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6807\u51c6\u5316 props class"}),"\n",(0,i.jsx)(e.li,{children:"\u7ed9 VNode \u6253\u4e0a\u7f16\u7801\u6807\u8bb0"}),"\n",(0,i.jsx)(e.li,{children:"\u521b\u5efa VNode"}),"\n",(0,i.jsx)(e.li,{children:"\u6807\u51c6\u5316\u5b50\u8282\u70b9"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"const vnode = createVNode(rootComponent,rootProps)"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"function createVNode(type, props = null, children = null) {\n  if (props) {\n    // \u5904\u7406props\u76f8\u5173\u903b\u8f91\uff0c\u6807\u51c6\u5316class\u548cstyle\n  }\n\n  // \u5bf9vnode\u7c7b\u578b\u4fe1\u606f\u7f16\u7801\n  const shapeFlag = isString(type)\n    ? 1 // ELEMENT\n    : isSuspense(type)\n    ? 128 // SUSPENSE\n    : isTeleport(type)\n    ? 64 // TELEPORT\n    : isObject(type)\n    ? 4 // STATEFUL_COMPONENT\n    : isFunction(type)\n    ? 2 // FUNCTIONAL_COMPONENT\n    : 0;\n\n  // \u521b\u5efavnode\u5bf9\u8c61\n  return createBaseVNode(\n    type,\n    props,\n    shapeFlag,\n    children\n    //...\u5176\u5b83\u5c5e\u6027\n  );\n}\n\nfunction createBaseVNode(\n  type,\n  props,\n  shapeFlag,\n  children = null,\n  patchFlag = 0,\n  dynamicProps = null,\n  isBlockNode = false,\n  needFullChildrenNormalization = false\n) {\n  const vnode = {\n    type,\n    props,\n    shapeFlag\n    // ...\u4e00\u4e9b\u5176\u5b83\u5c5e\u6027\n  };\n\n  if (needFullChildrenNormalization) {\n    // \u6807\u51c6\u5316\u5b50\u8282\u70b9\uff0c\u5c06\u4e0d\u540c\u6570\u636e\u7c7b\u578b\u7684children\u8f6c\u6210\u6570\u7ec4\u6216\u6587\u672c\u7c7b\u578b\n    normalizeChildren(vnode, children);\n  }\n  return vnode;\n}\n"})}),"\n",(0,i.jsx)(e.h5,{id:"\u6e32\u67d3-vnode",children:"\u6e32\u67d3 vnode"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"render(vnode,rootContainer)"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsxs)(e.strong,{children:[(0,i.jsx)(e.code,{children:"render"}),"\u5185\u90e8\u5b9e\u73b0"]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"const render = (vnode, container, namespace) => {\n  if (vnode == null) {\n    // \u9500\u6bc1\u7ec4\u4ef6\n    if (container._vnode) {\n      unmount(container._vnode, null, null, true);\n    }\n  } else {\n    // \u521b\u5efa\u6216\u66f4\u65b0\u7ec4\u4ef6\n    patch(\n      container._vnode || null,\n      vnode,\n      container,\n      null,\n      null,\n      null,\n      namespace\n    );\n  }\n  // \u7f13\u5b58vnode\u8282\u70b9\uff0c\u8868\u793a\u5df2\u7ecf\u6e32\u67d3\n  container._vnode = vnode;\n};\n\nconst patch = (\n  n1,\n  n2,\n  container,\n  anchor = null,\n  parentComponent = null,\n  parentSuspense = null,\n  namespace = undefined,\n  slotScopeIds = null,\n  optimized = false\n) => {\n  if (n1 === n2) {\n    return;\n  }\n\n  // \u5982\u679c\u5b58\u5728\u65b0\u65e7\u8282\u70b9\uff0c\u4e14\u65b0\u65e7\u8282\u70b9\u7c7b\u578b\u4e0d\u540c\uff0c\u5219\u9500\u6bc1\u65e7\u8282\u70b9\n  if (n1 && !isSameVNodeType(n1, n2)) {\n    anchor = getNextHostNode(n1);\n    unmount(n1, parentComponent, parentSuspense, true);\n    n1 = null;\n  }\n\n  const `{ type, shapeFlag }` = n2;\n  // \u5904\u7406\u8282\u70b9\u7684\u51fd\u6570\u53c2\u6570\u5173\u6ce8\uff1a\n  // n1 \u65e7\u7684vnode\uff0c\u5f53n1\u4e3anull\uff0c\u8868\u793a\u662f\u4e00\u6b21\u6302\u8f7d\u7684\u8fc7\u7a0b\n  // n2 \u65b0\u7684vnode,\u540e\u7eed\u4f1a\u6839\u636e\u8fd9\u4e2avnode\u7c7b\u578b\u6267\u884c\u4e0d\u540c\u7684\u5904\u7406\u903b\u8f91\n  // container \u8868\u793adom\u5bb9\u5668\uff0c\u5728vnode\u6e32\u67d3\u751f\u6210DOM\u540e\uff0c\u4f1a\u6302\u8f7d\u5230container\u4e0b\u9762\n  switch (type) {\n    case Text:\n      // \u5904\u7406\u6587\u672c\u8282\u70b9\n      break;\n    case Comment:\n      // \u5904\u7406\u6ce8\u91ca\u8282\u70b9\n      break;\n    case Static:\n      // \u5904\u7406\u9759\u6001\u8282\u70b9\n      break;\n    case Fragment:\n      // \u5904\u7406Fragment\u5143\u7d20\n      break;\n    default:\n      //ELEMENT\n      if (shapeFlag & 1) {\n        // \u5904\u7406\u666e\u901adom\u5143\u7d20\n        processElement(\n          n1,\n          n2,\n          container,\n          anchor,\n          parentComponent,\n          parentSuspense,\n          namespace,\n          slotScopeIds,\n          optimized\n        );\n      } else if (shapeFlag & 6) {\n        // COMPONENT\n        processComponent(\n          n1,\n          n2,\n          container,\n          anchor,\n          parentComponent,\n          parentSuspense,\n          namespace,\n          slotScopeIds,\n          optimized\n        );\n      } else if (shapeFlag & 64) {\n        // TELEPORT\n        type.process(\n          n1,\n          n2,\n          container,\n          anchor,\n          parentComponent,\n          parentSuspense,\n          namespace,\n          slotScopeIds,\n          optimized,\n          internals\n        );\n      } else if (__FEATURE_SUSPENSE__ && shapeFlag & 128) {\n        // SUSPENSE\n        type.process(\n          n1,\n          n2,\n          container,\n          anchor,\n          parentComponent,\n          parentSuspense,\n          namespace,\n          slotScopeIds,\n          optimized,\n          internals\n        );\n      } else if (__DEV__) {\n        warn('Invalid VNode type:', type, `($`{typeof type}`)`);\n      }\n  }\n};\n\n// \u2757\ufe0f\u7ec4\u4ef6\u7684processComponent\u51fd\u6570\u5b9e\u73b0\nconst processComponent = (\n  n1,\n  n2,\n  container,\n  anchor,\n  parentComponent,\n  parentSuspense,\n  namespace,\n  slotScopeIds,\n  optimized\n) => {\n  n2.slotScopeIds = slotScopeIds;\n\n  if (n1 == null) {\n    // \u6302\u8f7d\u7ec4\u4ef6\n    mountComponent(\n      n2,\n      container,\n      anchor,\n      parentComponent,\n      parentSuspense,\n      namespace,\n      optimized\n    );\n  } else {\n    // \u66f4\u65b0\u7ec4\u4ef6\n    updateComponent(n1, n2, optimized);\n  }\n};\n\n// \u3010\u7ec4\u4ef6processComponent\u51fd\u6570\u3011\u6302\u8f7d\u7ec4\u4ef6\u4ee3\u7801\u5b9e\u73b0\nconst mountComponent = (\n  initialVNode,\n  container,\n  anchor,\n  parentComponent,\n  parentSuspense,\n  namespace,\n  optimized\n) => {\n  // \u521b\u5efa\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u5185\u90e8\u901a\u8fc7\u5bf9\u8c61\u7684\u65b9\u5f0f\u521b\u5efa\u4e86\u5f53\u524d\u6e32\u67d3\u7684\u7ec4\u4ef6\u5b9e\u4f8b\n  const instance = (initialVNode.component = createComponentInstance(\n    initialVNode,\n    parentComponent,\n    parentSuspense\n  ));\n  // \u8bbe\u7f6e\u7ec4\u4ef6\u5b9e\u4f8b\uff0cinstance\u4fdd\u7559\u4e86\u5f88\u591a\u7ec4\u4ef6\u76f8\u5173\u7684\u6570\u636e\uff0c\u7ef4\u62a4\u4e86\u7ec4\u4ef6\u4e0a\u4e0b\u6587\u5305\u62ec\u5bf9props\u3001\u63d2\u69fd\u3001\u4ee5\u53ca\u5176\u5b83\u5b9e\u4f8b\u7684\u5c5e\u6027\u7684\u521d\u59cb\u5316\u5904\u7406\n  setupComponent(instance);\n  // \u8bbe\u7f6e\u5e76\u8fd0\u884c\u5e26\u526f\u4f5c\u7528\u7684\u6e32\u67d3\u51fd\u6570\n  setupRenderEffect(\n    instance,\n    initialVNode,\n    container,\n    anchor,\n    parentSuspense,\n    namespace,\n    optimized\n  );\n};\n"})}),"\n",(0,i.jsx)(e.h2,{id:"vue3-\u6e90\u7801\u7ed3\u6784",children:"vue3 \u6e90\u7801\u7ed3\u6784"}),"\n",(0,i.jsx)(e.h3,{id:"packages",children:"packages"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1compiler-core \u7f16\u8bd1\u5668\u6838\u5fc3\uff1aparse\u3001optimize\u3001codegen"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1compiler-dom \u7f16\u8bd1\u5668\u9488\u5bf9\u6d4f\u89c8\u5668\u7684\u7f16\u8bd1\u5668\uff0c\u5904\u7406\u6d4f\u89c8\u5668 dom \u76f8\u5173\u903b\u8f91"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1compiler-sfc \u7f16\u8bd1\u5668\u9488\u5bf9 vue \u5355\u6587\u4ef6\u7ec4\u4ef6\u7684\u7f16\u8bd1\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1compiler-ssr \u7f16\u8bd1\u5668\u9488\u5bf9\u670d\u52a1\u7aef\u6e32\u67d3\u7684\u7f16\u8bd1\u5668"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1reactivity \u54cd\u5e94\u5f0f\uff1adefineReactive\u3001proxy\u3001ref\u3001reactive\u3001computed\u3001watch"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1runtime-core \u6e32\u67d3\u5668\u6838\u5fc3\uff1ah\u3001createVNode\u3001renderSlot\u3001patchProp\u3001patchText\u3001patchClass\u3001patchStyle\u3001patchEvent\u3001processElement\u3001processComponent\u3001insert\u3001remove\u3001createApp"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1runtime-dom \u6e32\u67d3\u5668\u9488\u5bf9\u6d4f\u89c8\u5668\u7684\u8fd0\u884c\u65f6"}),"\n",(0,i.jsx)(e.li,{children:"\ud83d\udcc1server-renderer \u670d\u52a1\u7aef\u6e32\u67d3"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9a\u4e49\u54cd\u5e94\u5f0f\u6570\u636e",children:"\u5b9a\u4e49\u54cd\u5e94\u5f0f\u6570\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"// reactivity/reactive.ts\nfunction reactive(target) {\n  // \u5982\u679c\u5bf9\u8c61\u53ea\u8bfb\uff0c\u65e0\u6cd5\u88ab\u4fee\u6539\u6210\u54cd\u5e94\u5f0f\u5bf9\u8c61\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u8be5\u5bf9\u8c61\n  if (isReadonly(target)) {\n    return target;\n  }\n  return createReactiveObject(\n    target,\n    false,\n    mutableHandlers,\n    mutableCollectionHandlers,\n    reactiveMap\n  );\n}\n\nfunction createReactiveObject(\n  target,\n  isReadonly,\n  baseHandlers,\n  collectionHandlers,\n  proxyMap\n) {\n  // \u57fa\u7840\u6570\u636e\u76f4\u63a5\u8fd4\u56detarget\n  if (!isObject(target)) {\n    return target;\n  }\n\n  // \u8981\u6c42\u8fd4\u56de\u5bf9\u8c61\u7684\u539f\u59cb\u4e0d\u4ee3\u7406\u7248\u672c\uff0c\u5e76\u4e14\u5bf9\u8c61\u4e3a\u54cd\u5e94\u5f0f & \u975e\u53ea\u8bfb\n  if (\n    target[ReactiveFlags.RAW] &&\n    !(isReadonly && target[ReactiveFlags.IS_REACTIVE])\n  ) {\n    return target;\n  }\n\n  // \u68c0\u67e5\u662f\u5426\u5b58\u5728target\u5bf9\u5e94\u7684\u4ee3\u7406\n  const existingProxy = proxyMap.get(target);\n  if (existingProxy) {\n    return existingProxy;\n  }\n\n  // only specific value types can be observed.\n  const targetType = getTargetType(target);\n  if (targetType === TargetType.INVALID) {\n    return target;\n  }\n  const proxy = new Proxy(\n    target,\n    targetType === TargetType.COLLECTION ? collectionHandlers : baseHandlers\n  );\n  proxyMap.set(target, proxy);\n  return proxy;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"nexttick",children:"nextTick"}),"\n",(0,i.jsx)(e.h3,{id:"nexttick-\u7684\u51fa\u73b0\u662f\u56e0\u4e3a-dom-\u7684\u66f4\u65b0\u662f\u5f02\u6b65\u7684",children:"nextTick \u7684\u51fa\u73b0\u662f\u56e0\u4e3a dom \u7684\u66f4\u65b0\u662f\u5f02\u6b65\u7684"}),"\n",(0,i.jsx)(e.p,{children:"\u4ee5\u4e0b\u662f\u5b98\u7f51\u7684\u8bf4\u660e\uff1a"}),"\n",(0,i.jsx)(e.p,{children:"\u53ea\u8981\u4fa6\u542c\u5230\u6570\u636e\u53d8\u5316\uff0cVue \u5c06\u5f00\u542f\u4e00\u4e2a\u961f\u5217\uff0c\u5e76\u7f13\u51b2\u5728\u540c\u4e00\u4e8b\u4ef6\u5faa\u73af\u4e2d\u53d1\u751f\u7684\u6240\u6709\u6570\u636e\u53d8\u66f4\u3002\u5982\u679c\u540c\u4e00\u4e2a watcher \u88ab\u591a\u6b21\u89e6\u53d1\uff0c\u53ea\u4f1a\u88ab\u63a8\u5165\u5230\u961f\u5217\u4e2d\u4e00\u6b21\u3002\u8fd9\u79cd\u5728\u7f13\u51b2\u65f6\u53bb\u9664\u91cd\u590d\u6570\u636e\u5bf9\u4e8e\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u8ba1\u7b97\u548c DOM \u64cd\u4f5c\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u7136\u540e\uff0c\u5728\u4e0b\u4e00\u4e2a\u7684\u4e8b\u4ef6\u5faa\u73af\u201ctick\u201d\u4e2d\uff0cVue \u5237\u65b0\u961f\u5217\u5e76\u6267\u884c\u5b9e\u9645 (\u5df2\u53bb\u91cd\u7684) \u5de5\u4f5c\u3002Vue \u5728\u5185\u90e8\u5bf9\u5f02\u6b65\u961f\u5217\u5c1d\u8bd5\u4f7f\u7528\u539f\u751f\u7684 Promise.then\u3001MutationObserver \u548c setImmediate\uff0c\u5982\u679c\u6267\u884c\u73af\u5883\u4e0d\u652f\u6301\uff0c\u5219\u4f1a\u91c7\u7528 setTimeout(fn, 0) \u4ee3\u66ff\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"nextTick()"}),"\u53ef\u4ee5\u5728\u72b6\u6001\u6539\u53d8\u540e\u7acb\u5373\u4f7f\u7528\uff0c\u4ee5\u7b49\u5f85 DOM \u66f4\u65b0\u5b8c\u6210\u3002nextTick() \u8fd4\u56de\u7684\u662f Promise \u5bf9\u8c61,\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u6216\u8005 await \u8fd4\u56de\u7684 Promise\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.code,{children:"function nextTick(callback?: () => void): Promise<void>"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"nextTick()"}),"\u5b98\u7f51\u793a\u4f8b\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-vue",children:"<script setup>\nimport `{ ref, nextTick }` from 'vue';\n\nconst count = ref(0);\n\nasync function increment() {\n  count.value++;\n\n  // DOM \u8fd8\u672a\u66f4\u65b0\n  console.log(document.getElementById('counter').textContent); // 0\n\n  await nextTick();\n  // DOM \u6b64\u65f6\u5df2\u7ecf\u66f4\u65b0\n  console.log(document.getElementById('counter').textContent); // 1\n}\n<\/script>\n\n<template>\n  <button id=\"counter\" @click=\"increment\">`{{ count }`}</button>\n</template>\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9e\u73b0-nexttick",children:"\u5b9e\u73b0 nextTick"}),"\n",(0,i.jsx)(e.p,{children:"\u539f\u7406\uff1a\u57fa\u4e8e js \u7684\u4e8b\u4ef6\u5faa\u73af\u673a\u5236\u5b9e\u73b0\uff0c\u521b\u5efa\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1\uff0c\u5728\u540c\u6b65\u4efb\u52a1\u7ed3\u675f\u540e\u5373\u6267\u884c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"let currentFlushPromise: Promise<void> | null = null;\nconst resolvedPromise = Promise.resolve() as Promise<any>;\n\nexport function nextTick<T = void, R = void>(\n  this: T,\n  fn?: (this: T) => R\n): Promise<Awaited<R>> {\n  const p = currentFlushPromise || resolvedPromise;\n  return fn ? p.then(this ? fn.bind(this) : fn) : p;\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"vue3-\u4e2d\u4efb\u52a1\u8c03\u5ea6\u7684\u5b9e\u73b0\u8fc7\u7a0b",children:"\u2753vue3 \u4e2d\u4efb\u52a1\u8c03\u5ea6\u7684\u5b9e\u73b0\u8fc7\u7a0b"}),"\n",(0,i.jsxs)(e.p,{children:["\u6e90\u7801 renderer.ts \u6587\u4ef6\u4e2d\u7684",(0,i.jsx)(e.code,{children:"setupRenderEffect"}),"\u51fd\u6570\u662f\u5904\u7406\u7ec4\u4ef6\u6e32\u67d3\u7684\u6838\u5fc3\u51fd\u6570\u3002\nsetupRenderEffect \u51fd\u6570\u4e2d\u521b\u5efa\u4e86 update \u5bf9\u8c61"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:r(78418).A+"",width:"1106",height:"1296"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"queueJob()"}),"\u51fd\u6570\u7528\u4e8e \u7ef4\u62a4 job \u5217\u961f\uff0c\u5c06\u4e00\u4e2a\u4efb\u52a1 job \u6dfb\u52a0\u5230\u4efb\u52a1\u961f\u5217 queue\uff0c\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"queueFlush()"}),"\u51fd\u6570\u89e6\u53d1\u4efb\u52a1\u5237\u65b0 \u3002\u51fd\u6570\u4e2d\u6709\u53bb\u91cd\u903b\u8f91(\u91cd\u590d\u6570\u636e\u5220\u9664\u641c\u7d22\u4f7f\u7528 Array.includes() \u7684 startIndex \u53c2\u6570)\uff0c\u4fdd\u8bc1\u4efb\u52a1\u7684\u552f\u4e00\u6027\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u5177\u4f53\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5bf9 job \u4efb\u52a1\u8fdb\u884c\u5224\u65ad"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"1\ufe0f\u20e3 \u9996\u5148\u68c0\u67e5\u4efb\u52a1\u961f\u5217\u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u4e3a\u7a7a\uff0c\u76f4\u63a5\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u961f\u5217\u4e2d\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["2\ufe0f\u20e3 \u7136\u540e\uff0c\u4f7f\u7528 ",(0,i.jsx)(e.code,{children:"includes"})," \u65b9\u6cd5\u68c0\u67e5\u5f53\u524d\u4efb\u52a1 job \u662f\u5426\u5df2\u7ecf\u5728\u4efb\u52a1\u961f\u5217\u4e2d\u3002\u5982\u679c\u4efb\u52a1\u961f\u5217\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u5f53\u524d\u4efb\u52a1\uff0c\u5c31\u4e0d\u518d\u6dfb\u52a0\u3002"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5982\u679c job \u4efb\u52a1\u901a\u8fc7\u5224\u65ad\uff0c\u5c31\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u4efb\u52a1\u961f\u5217\u4e2d"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["1\ufe0f\u20e3 \u5982\u679c\u4efb\u52a1\u7684 id \u5c5e\u6027\u4e3a null\uff0c\u8868\u793a\u6ca1\u6709\u6307\u5b9a\u4efb\u52a1\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u76f4\u63a5\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u961f\u5217\u672b\u5c3e",(0,i.jsx)(e.code,{children:"queue.push(job)"}),"\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["2\ufe0f\u20e3 \u5982\u679c\u4efb\u52a1\u7684 id \u5c5e\u6027\u4e0d\u4e3a null\uff0c\u8868\u793a\u6307\u5b9a\u4e86\u4efb\u52a1\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u9700\u8981\u6839\u636e\u8be5\u6807\u8bc6\u627e\u5230\u5408\u9002\u7684\u63d2\u5165\u4f4d\u7f6e\uff0c\u4ee5\u4fdd\u6301\u4efb\u52a1\u961f\u5217\u4e2d\u7684\u4efb\u52a1\u6309\u7167 id \u7684\u987a\u5e8f\u6267\u884c\uff08\u6309\u7167 job id \u81ea\u589e\u7684\u987a\u5e8f\u6392\u5217\uff09\u3002\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"findInsertionIndex(job.id)"})," \u6765\u627e\u5230\u63d2\u5165\u4f4d\u7f6e\uff0c\u7136\u540e\u4f7f\u7528 splice \u65b9\u6cd5\u63d2\u5165\u4efb\u52a1\u5230\u6307\u5b9a\u4f4d\u7f6e"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u8c03\u7528 ",(0,i.jsx)(e.code,{children:"queueFlush()"}),"\u51fd\u6570\u89e6\u53d1\u4efb\u52a1\u5237\u65b0"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"// scheduler.ts\nexport function queueJob(job: SchedulerJob) {\n  if (\n    !queue.length ||\n    !queue.includes(\n      job,\n      isFlushing && job.allowRecurse ? flushIndex + 1 : flushIndex\n    )\n  ) {\n    if (job.id == null) {\n      queue.push(job);\n    } else {\n      queue.splice(findInsertionIndex(job.id), 0, job);\n    }\n    queueFlush();\n  }\n}\n\n// \u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u786e\u8ba4\u4f4d\u7f6e\u4fdd\u8bc1\u961f\u5217\u7684\u9012\u589e\u987a\u5e8f\nfunction findInsertionIndex(id: number) {\n  // the start index should be `flushIndex + 1`\n  let start = flushIndex + 1;\n  let end = queue.length;\n\n  while (start < end) {\n    const middle = (start + end) >>> 1;\n    const middleJob = queue[middle];\n    const middleJobId = getId(middleJob);\n    if (middleJobId < id || (middleJobId === id && middleJob.pre)) {\n      start = middle + 1;\n    } else {\n      end = middle;\n    }\n  }\n\n  return start;\n}\n\nfunction queueFlush() {\n  // \u6ca1\u6709\u6302\u8d77\u7684\u5237\u65b0\u8bf7\u6c42\u4e14\u6ca1\u6709\u6b63\u5728\u5237\u65b0\u4efb\u52a1\u961f\u5217\n  if (!isFlushing && !isFlushPending) {\n    isFlushPending = true; // \u5237\u65b0\u8bf7\u6c42\u88ab\u6302\u8d77\n    // \u5c06\u5237\u65b0\u64cd\u4f5c\u5305\u88c5\u6210 Promise\uff0c\u5c06 flushJobs \u653e\u5165\u4e0b\u4e00\u4e2a\u5fae\u4efb\u52a1\u4e2d\u6267\u884c\n    currentFlushPromise = resolvedPromise.then(flushJobs);\n  }\n}\n\nfunction flushJobs(seen?: CountMap) {\n  isFlushPending = false;\n  // \u6267\u884c\u5237\u65b0\u4efb\u52a1\u961f\u5217\u64cd\u4f5c\n  isFlushing = true;\n  if (__DEV__) {\n    seen = seen || new Map();\n  }\n  // \u5237\u65b0\u4e4b\u524d\u5bf9\u961f\u5217\u8fdb\u884c\u6392\u5e8f\uff0c\u786e\u4fdd\u7ec4\u4ef6\u4ece\u7236\u7ea7\u66f4\u65b0\u5230\u5b50\u7ea7\u3002\u5982\u679c\u5728\u7236\u7ec4\u4ef6\u66f4\u65b0\u671f\u95f4\u88ab\u5378\u8f7d\uff0c\u53ef\u4ee5\u8df3\u8fc7\u66f4\u65b0\n  queue.sort(comparator);\n\n  // \u68c0\u67e5\u662f\u5426\u5b58\u5728\u9012\u5f52\u66f4\u65b0\n  const check = __DEV__\n    ? (job: SchedulerJob) => checkRecursiveUpdates(seen!, job)\n    : NOOP;\n\n  try {\n    for (flushIndex = 0; flushIndex < queue.length; flushIndex++) {\n      const job = queue[flushIndex];\n      if (job && job.active !== false) {\n        if (__DEV__ && check(job)) {\n          continue;\n        }\n        callWithErrorHandling(job, null, ErrorCodes.SCHEDULER);\n      }\n    }\n  } finally {\n    // \u6e05\u7a7a flushIndex\uff0c\u91cd\u7f6e\u4efb\u52a1\u961f\u5217 queue\uff0c\u5237\u65b0\u4efb\u52a1\u7ed3\u675f\uff0c\u5c06\u5f53\u524d\u7684\u5237\u65b0promise\u7f6e\u4e3anull\uff0c\u786e\u4fdd\u4efb\u52a1\u53ea\u6267\u884c\u4e00\u6b21\u3002\n    flushIndex = 0;\n    queue.length = 0;\n\n    flushPostFlushCbs(seen);\n\n    isFlushing = false;\n    currentFlushPromise = null;\n\n    // \u5982\u679c\u4efb\u52a1\u961f\u5217 queue \u4e2d\u4ecd\u6709\u4efb\u52a1\uff0c\u6216\u8005\u6709\u6302\u8d77\u7684 postFlush \u56de\u8c03\u51fd\u6570\uff0c\u5c31\u7ee7\u7eed\u6267\u884c\u5237\u65b0\u64cd\u4f5c\uff0c\u76f4\u5230\u4efb\u52a1\u961f\u5217\u4e3a\u7a7a\u3002\n    if (queue.length || pendingPostFlushCbs.length) {\n      flushJobs(seen);\n    }\n  }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"queuePostFlushCb()"})," \u7ef4\u62a4 cb \u5217\u961f\uff0c\u88ab\u8c03\u7528\u7684\u65f6\u5019\u53bb\u91cd\uff0c\u6bcf\u6b21\u8c03\u7528\u53bb\u6267\u884c ",(0,i.jsx)(e.code,{children:"queueFlush()"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"export function queuePostFlushCb(cb: SchedulerJobs) {\n  if (!isArray(cb)) {\n    if (\n      !activePostFlushCbs ||\n      !activePostFlushCbs.includes(\n        cb,\n        cb.allowRecurse ? postFlushIndex + 1 : postFlushIndex\n      )\n    ) {\n      pendingPostFlushCbs.push(cb);\n    }\n  } else {\n    pendingPostFlushCbs.push(...cb);\n  }\n  queueFlush();\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"vue-\u6e32\u67d3\u8fc7\u7a0b",children:"vue \u6e32\u67d3\u8fc7\u7a0b"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8c03\u7528 Compile \u51fd\u6570\u751f\u6210 render \u51fd\u6570\u5b57\u7b26\u4e32,\u7f16\u8bd1\u8fc7\u7a0b\u5982\u4e0b:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"parse \u4f7f\u7528\u5927\u91cf\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5bf9 template \u5b57\u7b26\u4e32\u8fdb\u884c\u89e3\u6790\uff0c\u5c06\u6807\u7b7e\u3001\u6307\u4ee4\u3001\u5c5e\u6027\u7b49\u8f6c\u5316\u4e3a\u62bd\u8c61\u8bed\u6cd5\u6811 AST\u3002 \u3010\u6a21\u677f->AST(\u6700\u6d88\u8017\u6027\u80fd)\u3011"}),"\n",(0,i.jsx)(e.li,{children:"optimize \u904d\u5386 AST\uff0c\u627e\u5230\u5176\u4e2d\u7684\u4e00\u4e9b\u9759\u6001\u8282\u70b9\u5e76\u8fdb\u884c\u6807\u8bb0\uff0c\u65b9\u4fbf\u5728\u9875\u9762\u91cd\u65b0\u6e32\u67d3\u7684\u65f6\u5019\u8fdb\u884c diff \u6bd4\u8f83\u65f6\u76f4\u63a5\u8df3\u8fc7\u9759\u6001\u8282\u70b9\uff0c\u3010\u4f18\u5316 runtime \u7684\u6027\u80fd\u3011"}),"\n",(0,i.jsx)(e.li,{children:"generate \u5c06\u6700\u7ec8\u7684 AST \u8f6c\u5316\u4e3a render \u51fd\u6570\u5b57\u7b26\u4e32"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8c03\u7528 new Watcher \u51fd\u6570\uff0c\u76d1\u542c\u6570\u636e\u7684\u53d8\u5316\uff0c\u5f53\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\uff0cRender \u51fd\u6570\u6267\u884c \u751f\u6210 vnode \u5bf9\u8c61"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8c03\u7528 patch \u65b9\u6cd5,\u5bf9\u6bd4\u65b0\u65e7 vnode \u5bf9\u8c61,\u901a\u8fc7 DOM diff \u7b97\u6cd5,\u6dfb\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u771f\u6b63\u7684 DOM \u5143\u7d20"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"keep-alive-\u539f\u7406",children:"keep-alive \u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"keep-aliVe \u7ec4\u4ef6\u63a5\u53d7\u4e09\u4e2a\u5c5e\u6027\u53c2\u6570:include \u3001exclude\u3001max"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"include \u6307\u5b9a\u9700\u8981\u7f13\u5b58\u7684\u7ec4\u4ef6 name \u96c6\u5408\uff0c\u53c2\u6570\u683c\u5f0f\u652f\u6301 string\uff0cRegExp\uff0cArray\u3002 \u5f53\u4e3a\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0c\u591a\u4e2a\u7ec4\u4ef6\u540d\u79f0\u4ee5\u9017\u53f7\u9694\u5f00\u3002"}),"\n",(0,i.jsx)(e.li,{children:"exclude \u6307\u5b9a\u4e0d\u9700\u8981\u7f13\u5b58\u7684\u7ec4\u4ef6 name \u96c6\u5408\uff0c\u53c2\u6570\u683c\u5f0f\u548c include-\u6837\u3002"}),"\n",(0,i.jsx)(e.li,{children:"max \u6307\u5b9a\u6700\u591a\u53ef\u7f13\u5b58\u7ec4\u4ef6\u7684\u6570\u91cf,\u8d85\u8fc7\u6570\u91cf\u5220\u9664\u7b2c\u4e00\u4e2a\u3002\u53c2\u6570\u683c\u5f0f\u652f\u6301 String\u3001Number."}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"\u539f\u7406",children:"\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:"keep-alive \u5b9e\u4f8b\u4f1a\u7f13\u5b58\u5bf9\u5e94\u7ec4\u4ef6\u7684 vNode,\u5982\u679c\u547d\u4e2d\u7f13\u5b58\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u5bf9\u8c61\u8fd4\u53e3\u5bf9\u5e94 VNode\u3002"}),"\n",(0,i.jsx)(e.p,{children:"LRU(Least recently used)\u7b97\u6cd5\u6839\u636e\u6570\u636e\u7684\u5386\u53f2\u8bbf\u95ee\u8bb0\u5f55\u6765\u8fdb\u884c\u6dd8\u6c70\u6570\u636e\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u201d\u5982\u679c\u6570\u636e\u6700\u8fd1\u88ab\u8bbf\u95ee\u8fc7\uff0c\u90a3\u4e48\u5c06\u6765\u88ab\u8bbf\u95ee\u7684\u51e0\u7387\u4e5f\u66f4\u9ad8\u201d\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"diff",children:"diff"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u65b0\u8001\u865a\u62df DOM \u5bf9\u6bd4\u65f6"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9996\u5148\uff0c\u5bf9\u6bd4\u8282\u70b9\u672c\u8eab\uff0c\u5224\u65ad\u662f\u5426\u4e3a\u540c\u4e00\u8282\u70b9\uff0c\u5982\u679c\u4e0d\u4e3a\u76f8\u540c\u8282\u70b9\uff0c\u5219\u5220\u9664\u8be5\u8282\u70b9\u91cd\u65b0\u521b\u5efa\u8282\u70b9\u8fdb\u884c\u66ff\u6362"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u4e3a\u76f8\u540c\u8282\u70b9\uff0c\u8fdb\u884c patchVnode\uff0c\u5224\u65ad\u5982\u4f55\u5bf9\u8be5\u8282\u70b9\u7684\u5b50\u8282\u70b9\u8fdb\u884c\u5904\u7406\uff0c\u5148\u5224\u65ad\u4e00\u65b9\u6709\u5b50\u8282\u70b9\u4e00\u65b9\u6ca1\u6709\u5b50\u8282\u70b9\u7684\u60c5\u51b5(\u5982\u679c\u65b0\u7684 children \u6ca1\u6709\u5b50\u8282\u70b9\uff0c\u5c06\u65e7\u7684\u5b50\u8282\u70b9\u79fb\u9664)"}),"\n",(0,i.jsx)(e.li,{children:"\u6bd4\u8f83\u5982\u679c\u90fd\u6709\u5b50\u8282\u70b9\uff0c\u5219\u8fdb\u884c updateChildren\uff0c\u5224\u65ad\u5982\u4f55\u5bf9\u8fd9\u4e9b\u65b0\u8001\u8282\u70b9\u7684\u5b50\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c(diff \u6838\u5fc3)\u3002 \u5339\u914d\u65f6\uff0c\u627e\u5230\u76f8\u540c\u7684\u5b50\u8282\u70b9\uff0c\u9012\u5f52\u6bd4\u8f83\u5b50\u8282\u70b9"}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}},19305:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/vnode\u7ec4\u4ef6-989f75a4f6e67948b849938988ad4fba.png"},28453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>d});var s=r(96540);const i={},l=s.createContext(i);function o(n){const e=s.useContext(l);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),s.createElement(l.Provider,{value:e},n.children)}},46927:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/\u521d\u59cb\u5316-662b1525554572b5c2a16c2c291a08e0.png"},58046:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/block-dfb6dd3370811efcff0ffd9c8e43d946.png"},78418:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/setupRender-6fc96786fd78d8e426209079475d7b90.png"},81694:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/pnpm-79af45503aeca5eacd944d6326c96756.png"},86162:(n,e,r)=>{r.d(e,{A:()=>s});const s=r.p+"assets/images/workspace-80ed25c507a94d97188a23f1ec7224eb.png"}}]);